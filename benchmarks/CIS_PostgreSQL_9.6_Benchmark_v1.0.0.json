{
    "Benchmark": {
        "id": "xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_PostgreSQL_9.6_Benchmark",
        "title": "CIS PostgreSQL 9.6 Benchmark",
        "description": "<xhtml:p>  This document, CIS PostgreSQL 9.6 Benchmark, provides prescriptive guidance for establishing a secure configuration posture for PostgreSQL 9.6. This guide was tested against PostgreSQL 9.6 running on CentOS 6, but applies to other Linux distributions as well. To obtain the latest version of this guide, please visit   <xhtml:a href=\"http://benchmarks.cisecurity.org/\">    http://benchmarks.cisecurity.org  </xhtml:a>  . If you have questions, comments, or have identified ways to improve this guide, please write us at   <xhtml:a href=\"mailto:feedback@cisecurity.org\">    feedback@cisecurity.org  </xhtml:a>  .</xhtml:p>",
        "status": [
            {
                "accepted": "2022-04-14"
            }
        ],
        "platforms": [
            "cpe:2.3:a:postgresql:postgresql:9.6:*:*:*:*:*:*:*"
        ],
        "version": "1.0.0",
        "Profiles": [
            {
                "id": "xccdf_org.cisecurity.benchmarks_profile_Level_1_-_PostgreSQL",
                "title": "Level 1 - PostgreSQL",
                "description": "<xhtml:p>  Items in this profile apply to PostgreSQL 9.6 and intend to:</xhtml:p><xhtml:ul>  <xhtml:li>    be practical and prudent;  </xhtml:li>  <xhtml:li>    provide a clear security benefit; and  </xhtml:li>  <xhtml:li>    not inhibit the utility of the technology beyond acceptable means.  </xhtml:li></xhtml:ul><xhtml:p>  <xhtml:strong>    Note:  </xhtml:strong>   The intent of this profile is to include checks that can be assessed by remotely connecting to PostgreSQL. Therefore, file system-related checks are not contained in this profile.</xhtml:p>",
                "selects": [
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_the_log_destinations_are_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_the_logging_collector_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_the_log_file_destination_directory_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.5_Ensure_the_filename_pattern_for_log_files_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.6_Ensure_the_log_file_permissions_are_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.7_Ensure_log_truncate_on_rotation_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.8_Ensure_the_maximum_log_file_lifetime_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.9_Ensure_the_maximum_log_file_size_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.10_Ensure_the_correct_syslog_facility_is_selected",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.11_Ensure_the_program_name_for_PostgreSQL_syslog_messages_is_correct",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.12_Ensure_the_correct_messages_are_written_to_the_server_log",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.13_Ensure_the_correct_SQL_statements_generating_errors_are_recorded",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.14_Ensure_debug_print_parse_is_disabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.15_Ensure_debug_print_rewritten_is_disabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.16_Ensure_debug_print_plan_is_disabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.17_Ensure_debug_pretty_print_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.18_Ensure_log_connections_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.19_Ensure_log_disconnections_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.20_Ensure_log_error_verbosity_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.21_Ensure_log_hostname_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.22_Ensure_log_line_prefix_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.23_Ensure_log_statement_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.24_Ensure_log_timezone_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_the_PostgreSQL_Audit_Extension_pgAudit_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_excessive_administrative_privileges_are_revoked",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_excessive_DML_privileges_are_revoked",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_Row_Level_Security_RLS_is_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_the_set_user_extension_is_installed",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_Attack_Vectors_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_backend_runtime_parameters_are_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_Postmaster_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_SIGHUP_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.5_Ensure_Superuser_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_User_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_SSL_is_enabled_and_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_the_pgcrypto_extension_is_installed_and_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_SSL_Certificates_are_Configured_For_Replication",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_a_replication-only_user_is_created_and_used_for_streaming_replication",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_base_backups_are_configured_and_functional",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.5_Ensure_streaming_replication_parameters_are_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_PostgreSQL_configuration_files_are_outside_the_data_cluster",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.2_Ensure_PostgreSQL_subdirectory_locations_are_outside_the_data_cluster",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.4_Ensure_miscellaneous_configuration_settings_are_correct",
                            "selected": "true"
                        }
                    }
                ]
            },
            {
                "id": "xccdf_org.cisecurity.benchmarks_profile_Level_1_-_PostgreSQL_on_Linux",
                "title": "Level 1 - PostgreSQL on Linux",
                "description": "<xhtml:p>  Items in this profile apply to PostgreSQL 9.6 running on Linux and intend to:</xhtml:p><xhtml:ul>  <xhtml:li>    be practical and prudent;  </xhtml:li>  <xhtml:li>    provide a clear security benefit; and  </xhtml:li>  <xhtml:li>    not inhibit the utility of the technology beyond acceptable means.  </xhtml:li></xhtml:ul>",
                "selects": [
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_packages_are_obtained_from_authorized_repositories",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Installation_of_Binary_Packages",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Installation_of_Community_Packages",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Service_Runlevel_Is_Registered_And_Set_Correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_Data_Cluster_Initialized_Successfully",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_the_file_permissions_mask_is_correct",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_the_PostgreSQL_pg_wheel_group_membership_is_correct",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_the_log_destinations_are_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_the_logging_collector_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_the_log_file_destination_directory_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.5_Ensure_the_filename_pattern_for_log_files_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.6_Ensure_the_log_file_permissions_are_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.7_Ensure_log_truncate_on_rotation_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.8_Ensure_the_maximum_log_file_lifetime_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.9_Ensure_the_maximum_log_file_size_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.10_Ensure_the_correct_syslog_facility_is_selected",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.11_Ensure_the_program_name_for_PostgreSQL_syslog_messages_is_correct",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.12_Ensure_the_correct_messages_are_written_to_the_server_log",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.13_Ensure_the_correct_SQL_statements_generating_errors_are_recorded",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.14_Ensure_debug_print_parse_is_disabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.15_Ensure_debug_print_rewritten_is_disabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.16_Ensure_debug_print_plan_is_disabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.17_Ensure_debug_pretty_print_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.18_Ensure_log_connections_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.19_Ensure_log_disconnections_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.20_Ensure_log_error_verbosity_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.21_Ensure_log_hostname_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.22_Ensure_log_line_prefix_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.23_Ensure_log_statement_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.1.24_Ensure_log_timezone_is_set_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_the_PostgreSQL_Audit_Extension_pgAudit_is_enabled",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_sudo_is_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_excessive_administrative_privileges_are_revoked",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_excessive_function_privileges_are_revoked",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_excessive_DML_privileges_are_revoked",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_Row_Level_Security_RLS_is_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_the_set_user_extension_is_installed",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_login_via_local_UNIX_Domain_Socket_is_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_login_via_host_TCPIP_Socket_is_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_Attack_Vectors_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_backend_runtime_parameters_are_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_Postmaster_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_SIGHUP_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.5_Ensure_Superuser_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_User_Runtime_Parameters_are_Configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_FIPS_140-2_OpenSSL_Cryptography_Is_Used",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_SSL_is_enabled_and_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_the_pgcrypto_extension_is_installed_and_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_SSL_Certificates_are_Configured_For_Replication",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_a_replication-only_user_is_created_and_used_for_streaming_replication",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_base_backups_are_configured_and_functional",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.4_Ensure_WAL_archiving_is_configured_and_functional",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_7.5_Ensure_streaming_replication_parameters_are_configured_correctly",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_PostgreSQL_configuration_files_are_outside_the_data_cluster",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.2_Ensure_PostgreSQL_subdirectory_locations_are_outside_the_data_cluster",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.3_Ensure_the_backup_and_restore_tool_pgBackRest_is_installed_and_configured",
                            "selected": "true"
                        }
                    },
                    {
                        "select": {
                            "idref": "xccdf_org.cisecurity.benchmarks_rule_8.4_Ensure_miscellaneous_configuration_settings_are_correct",
                            "selected": "true"
                        }
                    }
                ]
            }
        ],
        "Guidelines": [
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_1_Installation_and_Patches",
                    "title": "Installation and Patches",
                    "description": "<xhtml:p>  One of the best ways to ensure secure PostgreSQL security is to implement security updates as they come out, along with any applicable OS patches that will not interfere with system operations. It is additionally prudent to ensure the installed version has not reached end-of-life.</xhtml:p>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_packages_are_obtained_from_authorized_repositories",
                                        "title": "Ensure packages are obtained from authorized repositories",
                                        "description": "<xhtml:p>  When obtaining and installing software packages (typically via   <xhtml:span class=\"inline_block\">    yum  </xhtml:span>  ), it's imperative that packages are sourced only from valid and authorized repositories. For PostgreSQL, a short list of valid repositories would include CentOS (  <xhtml:a href=\"https://www.centos.org\">    www.centos.org  </xhtml:a>  ) and the official PostgreSQL website (  <xhtml:a href=\"https://yum.postgresql.org\">    yum.postgresql.org  </xhtml:a>  ).</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": {
                                                    "implementationGroup": null,
                                                    "title": null,
                                                    "urn": null,
                                                    "securityFunction": null,
                                                    "assetType": null
                                                },
                                                "control": [
                                                    {
                                                        "title": "Inventory and Control of Software Assets",
                                                        "urn": "urn:cisecurity.org:controls:7.0:2"
                                                    },
                                                    {
                                                        "title": "Inventory of Authorized and Unauthorized Software",
                                                        "urn": "urn:cisecurity.org:controls:6.0:2"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Being open source, PostgreSQL packages are widely available across the internet through RPM aggregators and providers. However, using invalid or unauthorized sources for packages can lead to implementing untested, defective, or malicious software.</xhtml:p><xhtml:p>  Many organizations choose to implement a local   <xhtml:span class=\"inline_block\">    yum  </xhtml:span>   repository within their organization. Care must be taken to ensure that only valid and authorized packages are downloaded and installed into such local repositories.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/2"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://wiki.centos.org/PackageManagement/Yum/"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.centos.org/docs/5/html/5.2/Deployment_Guide/s1-yum-yumconf-repository.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://en.wikipedia.org/wiki/Yum_(software)"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.howtoforge.com/creating_a_local_yum_repository_centos"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://yum.postgresql.org"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Alter the configured repositories so they only include valid and authorized sources of packages.    </xhtml:p>    <xhtml:p>      As an example of adding an authorized repository, we will install the PGDG repository RPM from '      <xhtml:a href=\"https://yum.postgresql.org\">        yum.postgresql.org      </xhtml:a>      ':    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ rpm -ivh https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-6-x86_64/pgdg-centos96-9.6-3.noarch.rpm      <br/>      Retrieving https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-6-x86_64/pgdg-centos96-9.6-3.noarch.rpm      <br/>      warning: /var/tmp/rpm-tmp.xU8FK1: Header V4 DSA/SHA1 Signature, key ID 442df0f8: NOKEY      <br/>      Preparing...                ########################################### [100%]      <br/>         1:pgdg-centos96          ########################################### [100%]    </xhtml:code>    <xhtml:p>      Verify the repository has been added and is enabled:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ yum repolist all | grep enabled:      <br/>      base                        CentOS-6 - Base                    enabled: 6,713      <br/>      extras                      CentOS-6 - Extras                  enabled:    31      <br/>      pgdg96                      PostgreSQL 9.6 6 - x86_64          enabled:   536      <br/>      updates                     CentOS-6 - Updates                 enabled:    96    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Installation_of_Binary_Packages",
                                        "title": "Ensure Installation of Binary Packages",
                                        "description": "<xhtml:p>  The PostgreSQL packages are installed on the Operating System from valid source.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": {
                                                    "implementationGroup": null,
                                                    "title": null,
                                                    "urn": null,
                                                    "securityFunction": null,
                                                    "assetType": null
                                                },
                                                "control": [
                                                    {
                                                        "title": "Inventory and Control of Software Assets",
                                                        "urn": "urn:cisecurity.org:controls:7.0:2"
                                                    },
                                                    {
                                                        "title": "Inventory of Authorized and Unauthorized Software",
                                                        "urn": "urn:cisecurity.org:controls:6.0:2"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Standard Linux distributions, although possessing the requisite packages, often do not have PostgreSQL pre-installed. The installation process includes installing the binaries and the means to generate a data cluster too. Package installation should include both the server and client packages. Contribution modules are optional depending upon one's architectural requirements (they are recommended though).</xhtml:p><xhtml:p>  From a security perspective, it's imperative to verify the PostgreSQL binary packages are sourced from a valid Linux   <xhtml:span class=\"inline_block\">    yum  </xhtml:span>   repository. The most common Linux repositories include CentOS base and PGDG base; however, it's up to the organization to validate. For a complete listing of all PostgreSQL binaries available via configured repositories inspect the output from   <xhtml:span class=\"inline_block\">    yum provides postgres*  </xhtml:span>  .</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/2"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      If the version of PostgreSQL installed is not 9.6.x, the packages may be uninstalled using this command:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ yum remove $(rpm -qa|grep postgres)    </xhtml:code>    <xhtml:p>      The next recommendation \"1.3 Ensure Installation of Community Packages\" describes how to explicitly choose which version of PostgreSQL to install, regardless of Linux distribution association.    </xhtml:p>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        If the PostgreSQL version shipped as part of the default binary installation associated with your Linux distribution satisfies your requirements, this may be adequate         <xhtml:em>          for development and testing purposes        </xhtml:em>        . However,         <xhtml:em>          for production instances        </xhtml:em>         it's generally recommended to install the         <xhtml:em>          latest stable release        </xhtml:em>         of PostgreSQL.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74307",
                                                        "artifact_title": "PostgreSQL Binaries are Installed",
                                                        "artifact": {
                                                            "type": "linux.software_package_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "package",
                                                                        "dt": "string",
                                                                        "value": "^(?i)postgres.*$"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "operation",
                                                                        "dt": "string",
                                                                        "value": "pattern match"
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "null_test_v1",
                                                            "parameters": [
                                                                
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Installation_of_Community_Packages",
                                        "title": "Ensure Installation of Community Packages",
                                        "description": "<xhtml:p>  Adding, and installing, the PostgreSQL community packages to the host's package repository.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Verify That Acquired Software is Still Supported",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18:3",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Use Only Vendor-supported Software",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  It's an unfortunate reality that Linux distributions do not always have the most up-to-date versions of PostgreSQL. Disadvantages of older releases include: missing bug patches, no access to highly desirable contribution modules, no access to 3rd party projects that are complimentary to PostgreSQL, and no upgrade path migrating from one version of PostgreSQL to the next. The worst set of circumstances is to be limited to a version of the RDBMS that has reached its end-of-life.</xhtml:p><xhtml:p>  From a security perspective, it's imperative that Postgres Community Packages are only obtained from the official website   <xhtml:a href=\"https://yum.postgresql.org/\">    https://yum.postgresql.org/  </xhtml:a>  . Being open source, the Postgres packages are widely available over the internet via myriad package aggregators and providers. Obtaining software from these unofficial sites risks installing defective, corrupt, or downright malicious versions of PostgreSQL.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/3"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/support/versioning/"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/developer/roadmap/"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://yum.postgresql.org/repopackages.php"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      The following example blocks the outdated distro packages, adds the PGDG repository RPM for PostgreSQL version 9.6, and installs the client-server-contributions rpms to the host where you want to install the RDBMS:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ vi /etc/yum.repos.d/CentOS-Base.repo      <br/>      [base]      <br/>      name=CentOS-$releasever - Base      <br/>      mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;amp;arch=$basearch&amp;amp;repo      <br/>      =os&amp;amp;infra=$infra      <br/>      #baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/      <br/>      gpgcheck=1      <br/>      gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6      <br/>      exclude=postgresql*  &lt;-- add this line      <br/>      <br/>      #released updates      <br/>      [updates]      <br/>      name=CentOS-$releasever - Updates      <br/>      mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;amp;arch=$basearch&amp;amp;repo      <br/>      =updates&amp;amp;infra=$infra      <br/>      #baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/      <br/>      gpgcheck=1      <br/>      gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6      <br/>      exclude=postgresql*  &lt;-- add this line    </xhtml:code>    <xhtml:p>      Using a web browser, go to       <xhtml:a href=\"http://yum.postgresql.org\">        http://yum.postgresql.org      </xhtml:a>       and navigate to the repo download link for your OS and version:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ yum -y install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-6-x86_64/pgdg-centos96-9.6-3.noarch.rpm    </xhtml:code>    <xhtml:p>      Finally, install the PostgreSQL packages:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ yum -y groupinstall \"PostgreSQL Database Server 9.6 PGDG\"      <br/>      Loaded plugins: fastestmirror      <br/>      Setting up Group Process      <br/>      Loading mirror speeds from cached hostfile      <br/>       * base: mirror.us.oneandone.net      <br/>       * extras: centos.mirrors.tds.net      <br/>       * updates: mirror.cisp.com      <br/>      base                                                     | 3.7 kB     00:00      <br/>      extras                                                   | 3.4 kB     00:00      <br/>      updates                                                  | 3.4 kB     00:00      <br/>      base/group_gz                                            | 242 kB     00:00      <br/>      pgdg96/group_gz                                          |  249 B     00:00      <br/>      Resolving Dependencies      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package postgresql96.x86_64 0:9.6.10-1PGDG.rhel6 will be installed      <br/>      ---&gt; Package postgresql96-contrib.x86_64 0:9.6.10-1PGDG.rhel6 will be installed      <br/>      --&gt; Processing Dependency: libxslt.so.1(LIBXML2_1.0.22)(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64      <br/>      --&gt; Processing Dependency: libxslt.so.1(LIBXML2_1.0.18)(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64      <br/>      --&gt; Processing Dependency: libxslt.so.1(LIBXML2_1.0.11)(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64      <br/>      --&gt; Processing Dependency: libxslt.so.1()(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64      <br/>      ---&gt; Package postgresql96-libs.x86_64 0:9.6.10-1PGDG.rhel6 will be installed      <br/>      ---&gt; Package postgresql96-server.x86_64 0:9.6.10-1PGDG.rhel6 will be installed      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package libxslt.x86_64 0:1.1.26-2.el6_3.1 will be installed      <br/>      --&gt; Finished Dependency Resolution      <br/>      <br/>      Dependencies Resolved      <br/>      <br/>      ================================================================================      <br/>       Package                  Arch       Version                   Repository  Size      <br/>      ================================================================================      <br/>      Installing:      <br/>       postgresql96             x86_64     9.6.10-1PGDG.rhel6        pgdg96     1.4 M      <br/>       postgresql96-contrib     x86_64     9.6.10-1PGDG.rhel6        pgdg96     492 k      <br/>       postgresql96-libs        x86_64     9.6.10-1PGDG.rhel6        pgdg96     289 k      <br/>       postgresql96-server      x86_64     9.6.10-1PGDG.rhel6        pgdg96     5.0 M      <br/>      Installing for dependencies:      <br/>       libxslt                  x86_64     1.1.26-2.el6_3.1          base       452 k      <br/>      <br/>      Transaction Summary      <br/>      ================================================================================      <br/>      Install       5 Package(s)      <br/>      <br/>      Total download size: 7.7 M      <br/>      Installed size: 31 M      <br/>      Downloading Packages:      <br/>      (1/5): libxslt-1.1.26-2.el6_3.1.x86_64.rpm               | 452 kB     00:00      <br/>      (2/5): postgresql96-9.6.10-1PGDG.rhel6.x86_64.rpm        | 1.4 MB     00:01      <br/>      (3/5): postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64.rp | 492 kB     00:00      <br/>      (4/5): postgresql96-libs-9.6.10-1PGDG.rhel6.x86_64.rpm   | 289 kB     00:00      <br/>      (5/5): postgresql96-server-9.6.10-1PGDG.rhel6.x86_64.rpm | 5.0 MB     00:00      <br/>      --------------------------------------------------------------------------------      <br/>      Total                                           2.5 MB/s | 7.7 MB     00:03      <br/>      Running rpm_check_debug      <br/>      Running Transaction Test      <br/>      Transaction Test Succeeded      <br/>      Running Transaction      <br/>        Installing : postgresql96-libs-9.6.10-1PGDG.rhel6.x86_64                  1/5      <br/>        Installing : postgresql96-9.6.10-1PGDG.rhel6.x86_64                       2/5      <br/>        Installing : libxslt-1.1.26-2.el6_3.1.x86_64                              3/5      <br/>        Installing : postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64               4/5      <br/>        Installing : postgresql96-server-9.6.10-1PGDG.rhel6.x86_64                5/5      <br/>        Verifying  : libxslt-1.1.26-2.el6_3.1.x86_64                              1/5      <br/>        Verifying  : postgresql96-9.6.10-1PGDG.rhel6.x86_64                       2/5      <br/>        Verifying  : postgresql96-libs-9.6.10-1PGDG.rhel6.x86_64                  3/5      <br/>        Verifying  : postgresql96-server-9.6.10-1PGDG.rhel6.x86_64                4/5      <br/>        Verifying  : postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64               5/5      <br/>      <br/>      Installed:      <br/>        postgresql96.x86_64 0:9.6.10-1PGDG.rhel6      <br/>        postgresql96-contrib.x86_64 0:9.6.10-1PGDG.rhel6      <br/>        postgresql96-libs.x86_64 0:9.6.10-1PGDG.rhel6      <br/>        postgresql96-server.x86_64 0:9.6.10-1PGDG.rhel6      <br/>      <br/>      Dependency Installed:      <br/>        libxslt.x86_64 0:1.1.26-2.el6_3.1      <br/>      <br/>      Complete!    </xhtml:code>    <xhtml:p>      <xhtml:strong>        Note:      </xhtml:strong>       The above-mentioned example is referenced as an illustration only. Package names and versions may differ.    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74308",
                                                        "artifact_title": "PostgreSQL Community Packages are Installed",
                                                        "artifact": {
                                                            "type": "linux.software_package_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "package",
                                                                        "dt": "string",
                                                                        "value": "^(?i)postgres.*$"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "operation",
                                                                        "dt": "string",
                                                                        "value": "pattern match"
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "null_test_v1",
                                                            "parameters": [
                                                                
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Service_Runlevel_Is_Registered_And_Set_Correctly",
                                        "title": "Ensure Service Runlevel Is Registered And Set Correctly",
                                        "description": "<xhtml:p>  Confirm, and set if necessary, the PostgreSQL runlevel on SYSV operating systems.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": {
                                                    "implementationGroup": null,
                                                    "title": null,
                                                    "urn": null,
                                                    "securityFunction": null,
                                                    "assetType": null
                                                },
                                                "control": [
                                                    {
                                                        "title": "Application Software Security",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18"
                                                    },
                                                    {
                                                        "title": "Application Software Security",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Setting the runlevel on a SYSV OS ensures the database service is active when a change of state occurs as in the case of a system startup, reboot, or an explicit change of runlevel by the Sys Admin.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://linuxcommand.org/man_pages/runlevel8.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://linuxcommand.org/man_pages/chkconfig8.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.tldp.org/LDP/sag/html/run-levels-intro.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Irrespective of package source, PostgreSQL services can be identified because it typically includes the text string \"postgresql\". Correct installs automatically register the service although it may still be off. Multiple instances of PostgreSQL services often distinguish themselves using a version number. Unregistered services must be added before its runlevel can be administrated.    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ chkconfig --add postgresql-9.6 &lt;-- registers if not already      <br/>      $ chkconfig --level 3 postgresql-9.6 on      <br/>      $ chkconfig --list | grep postgres      <br/>      postgresql-9.6 \t0:off\t1:off\t2:off\t3:on\t4:off\t5:off\t6:off    </xhtml:code>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74309",
                                                        "artifact_title": "Ensure the PostgreSQL Runlevel '3' is set to 'on'",
                                                        "artifact": {
                                                            "type": "unix.chkconfig_service_v2",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "service",
                                                                        "dt": "string",
                                                                        "value": "postgres*"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "name_operation",
                                                                        "dt": "string",
                                                                        "value": "pattern match"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "runlevel",
                                                                        "dt": "string",
                                                                        "value": "3"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "runlevel_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "unix.service_enabled_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "enabled",
                                                                        "dt": "string",
                                                                        "value": "Yes"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_Data_Cluster_Initialized_Successfully",
                                        "title": "Ensure Data Cluster Initialized Successfully",
                                        "description": "<xhtml:p>  First time installs of PostgreSQL requires the instantiation of the database cluster. A database cluster is a collection of databases that are managed by a single server instance.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Protect Information through  Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:6",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Protect Information With Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  For the purposes of security, PostgreSQL enforces ownership and permissions of the data-cluster such that:</xhtml:p><xhtml:ul>  <xhtml:li>    An initialized data-cluster is owned by the UNIX account that created it.  </xhtml:li>  <xhtml:li>    The data-cluster cannot be accessed by other UNIX user-accounts.  </xhtml:li>  <xhtml:li>    The data-cluster cannot be created or owned by     <xhtml:span class=\"inline_block\">      root    </xhtml:span>  </xhtml:li>  <xhtml:li>    The PostgreSQL process cannot be invoked by     <xhtml:span class=\"inline_block\">      root    </xhtml:span>     nor any UNIX user account other than the owner of the data cluster.  </xhtml:li></xhtml:ul><xhtml:p>  Incorrectly instantiating the data-cluster will result in a failed installation.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Attempting to instantiate a data cluster to an existing non-empty directory will fail:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ service postgresql-9.6 initdb      <br/>      Data directory is not empty!      <br/>      $                                       [FAILED]    </xhtml:code>    <xhtml:p>      In the case of a cluster instantiation failure, one must delete/remove the entire data cluster directory and repeat the       <xhtml:span class=\"inline_block\">        initdb      </xhtml:span>       command:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ rm -rf ~postgres/9.6      <br/>      $ service postgresql-9.6 initdb      <br/>      Initializing database:                                     [  OK  ]    </xhtml:code>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74310",
                                                        "artifact_title": "Ensure '700:postgres:postgres' Permissions On 'postgres'",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "select regexp_matches(setting, '\\/.*\\/') from pg_settings where name = 'data_directory';"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "SQL-Unix_File_or_Directory_Permissions_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "username",
                                                                        "dt": "string",
                                                                        "value": "postgres"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "group",
                                                                        "dt": "string",
                                                                        "value": "postgres"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "uread",
                                                                        "dt": "boolean",
                                                                        "value": "true"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "uwrite",
                                                                        "dt": "boolean",
                                                                        "value": "true"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "uexec",
                                                                        "dt": "boolean",
                                                                        "value": "true"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "gread",
                                                                        "dt": "boolean",
                                                                        "value": "false"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "gwrite",
                                                                        "dt": "boolean",
                                                                        "value": "false"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "gexec",
                                                                        "dt": "boolean",
                                                                        "value": "false"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "oread",
                                                                        "dt": "boolean",
                                                                        "value": "false"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "owrite",
                                                                        "dt": "boolean",
                                                                        "value": "false"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "oexec",
                                                                        "dt": "boolean",
                                                                        "value": "false"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "dir_only",
                                                                        "dt": "boolean",
                                                                        "value": "true"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_2_Directory_and_File_Permissions",
                    "title": "Directory and File Permissions",
                    "description": "<xhtml:p>  This section provides guidance on securing all operating system specific objects for PostgreSQL.</xhtml:p>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_the_file_permissions_mask_is_correct",
                                        "title": "Ensure the file permissions mask is correct",
                                        "description": "<xhtml:p>  Files are always created using a default set of permissions. File permissions can be restricted by applying a permissions mask called the   <xhtml:strong>    <xhtml:span class=\"inline_block\">      umask    </xhtml:span>  </xhtml:strong>  . The   <xhtml:span class=\"inline_block\">    postgres  </xhtml:span>   user account should use a umask of   <xhtml:span class=\"inline_block\">    077  </xhtml:span>   to deny file access to all user accounts except the owner.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Protect Information through  Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:6",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Protect Information With Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  The Linux OS defaults the umask to   <xhtml:span class=\"inline_block\">    002  </xhtml:span>  , which means the owner and primary group can read and write the file, and other accounts are permitted to read the file. Not explicitly setting the umask to a value as restrictive as   <xhtml:span class=\"inline_block\">    077  </xhtml:span>   allows other users to read, write, or even execute files and scripts created by the   <xhtml:span class=\"inline_block\">    postgres  </xhtml:span>   user account. The alternative to using a umask is explicitly updating file permissions after file creation using the command line utility   <xhtml:span class=\"inline_block\">    chmod  </xhtml:span>   (a manual and error prone process that is not advised).</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Depending upon the       <xhtml:span class=\"inline_block\">        postgres      </xhtml:span>       user's environment, the umask is typically set in the initialization file       <xhtml:span class=\"inline_block\">        .bash_profile      </xhtml:span>      , but may also be set in       <xhtml:span class=\"inline_block\">        .profile      </xhtml:span>       or       <xhtml:span class=\"inline_block\">        .bashrc      </xhtml:span>      . To set the umask, add the following to the appropriate profile file:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      postgres      <br/>      $ cd ~      <br/>      $ ls -ld .{bash_profile,profile,bashrc}      <br/>      ls: cannot access .profile: No such file or directory      <br/>      ls: cannot access .bashrc: No such file or directory      <br/>      -rwx------. 1 postgres postgres 267 Aug 14 12:59 .bash_profile      <br/>      $ echo \"umask 077\" &gt;&gt; .bash_profile      <br/>      $ source .bash_profile      <br/>      $ umask      <br/>      0077    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_the_PostgreSQL_pg_wheel_group_membership_is_correct",
                                        "title": "Ensure the PostgreSQL pg_wheel group membership is correct",
                                        "description": "<xhtml:p>  The group   <xhtml:span class=\"inline_block\">    pg_wheel  </xhtml:span>   is explicitly created on a host where the PostgreSQL server is installed. Membership in this group enables an ordinary user account to gain 'superuser' access to a database cluster by using the   <xhtml:span class=\"inline_block\">    sudo  </xhtml:span>   command (See 'Ensure sudo is configured correctly' later in this benchmark). Only user accounts authorized to have superuser access should be members of the   <xhtml:span class=\"inline_block\">    pg_wheel  </xhtml:span>   group.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Protect Information through  Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:6",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Protect Information With Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Users with unauthorized membership in the   <xhtml:span class=\"inline_block\">    pg_wheel  </xhtml:span>   group can assume the privileges of the owner of the PostgreSQL RDBMS and administer the database, as well as accessing scripts, files, and other executables they should not be able to access.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://man7.org/linux/man-pages/man1/groups.1.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://man7.org/linux/man-pages/man8/getent.1.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://man7.org/linux/man-pages/man8/gpasswd.1.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://man7.org/linux/man-pages/man8/useradd.8.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://en.wikipedia.org/wiki/Wheel_%28Unix_term%29"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      If the       <xhtml:span class=\"inline_block\">        pg_wheel      </xhtml:span>       group does not exist, use the following command to create it:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ groupadd pg_wheel &amp;&amp; getent group pg_wheel      <br/>      pg_wheel:x:502:    </xhtml:code>    <xhtml:p>      <xhtml:strong>        Note:      </xhtml:strong>       that your system's group number may not be 502. That's OK.    </xhtml:p>    <xhtml:p>      Adding the       <xhtml:span class=\"inline_block\">        postgres      </xhtml:span>       user to the newly created group is done by issuing:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ gpasswd -a postgres pg_wheel      <br/>      Adding user postgres to group pg_wheel      <br/>      $ # verify membership      <br/>      $ awk -F':' '/pg_wheel/{print $4}' /etc/group      <br/>      postgres    </xhtml:code>    <xhtml:p>      Removing a user account from the 'pg_wheel' group is achieved by executing the following command:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ gpasswd -d pg_wheel postgres      <br/>      Removing user postgres from group pg_wheel      <br/>      $ # verify the user was removed      <br/>      $ awk -F':' '/pg_wheel/{print $4}' /etc/group      <br/>      $    </xhtml:code>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74311",
                                                        "artifact_title": "Ensure 'pg_wheel' group exists.",
                                                        "artifact": {
                                                            "type": "sce_check_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "script",
                                                                        "dt": "string",
                                                                        "value": "find_pgwheel_group.sh"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "export_variable_value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "export_variable_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "export_variable_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "null_test_v1",
                                                            "parameters": [
                                                                
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_3_Logging_Monitoring_And_Auditing_Centos_6",
                    "title": "Logging Monitoring And Auditing (Centos 6)",
                    "description": "<xhtml:p>  This section provides guidance with respect to PostgreSQL's auditing and logging behavior.</xhtml:p>",
                    "Groups": [
                        {
                            "Group": {
                                "id": "xccdf_org.cisecurity.benchmarks_group_3.1_PostgreSQL_Logging",
                                "title": "PostgreSQL Logging",
                                "description": "<xhtml:p>  This section provides guidance with respect to PostgreSQL's logging behavior   <xhtml:em>    as it applies to security and auditing  </xhtml:em>  . PostgreSQL contains significantly more logging options that are not audit and/or security related (and as such, are not covered herein).</xhtml:p>",
                                "Groups": [
                                    {
                                        "Group": {
                                            "id": "xccdf_org.cisecurity.benchmarks_group_3.1.1_Logging_Rationale",
                                            "title": "Logging Rationale",
                                            "description": "<xhtml:p>  Having an audit trail is an important feature of any relational database system. You want enough detail to describe when an event of interest has started and stopped, what the event is/was, the event's cause, and what the event did/is doing to the system.</xhtml:p><xhtml:p>  Ideally, the logged information is in a format permitting further analysis giving us new perspectives and insight.</xhtml:p><xhtml:p>  The PostgreSQL configuration file   <xhtml:span class=\"inline_block\">    postgresql.conf  </xhtml:span>   is where all adjustable parameters can be set. A configuration file is created as part of the data cluster's creation i.e.   <xhtml:span class=\"inline_block\">    initdb  </xhtml:span>  . The configuration file enumerates all tunable parameters and even though most of them are commented out it is understood that they are in fact active and at those very same documented values. The reason that they are commented out is to signify their default values. Uncommenting them will force the server to read these values instead of using the default values.</xhtml:p>"
                                        }
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_the_log_destinations_are_set_correctly",
                                                    "title": "Ensure the log destinations are set correctly",
                                                    "description": "<xhtml:p>  PostgreSQL supports several methods for logging server messages, including   <xhtml:span class=\"inline_block\">    stderr  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    csvlog  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    syslog  </xhtml:span>  . On Windows,   <xhtml:span class=\"inline_block\">    eventlog  </xhtml:span>   is also supported. One or more of these destinations should be set for server log output.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Activate audit logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "true",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Log Settings Support Appropriate Log Entry Formatting",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If   <xhtml:span class=\"inline_block\">    log_destination  </xhtml:span>   is not set, then any log messages generated by the core PostgreSQL processes will be lost.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statements to remediate this setting (in this example, setting the log destination to       <xhtml:span class=\"inline_block\">        csvlog      </xhtml:span>      ):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_destination = 'csvlog';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      <xhtml:strong>        Note:      </xhtml:strong>       If more than one log destination is to be used, set this parameter to a list of desired log destinations separated by commas (e.g. 'csvlog, stderr').    </xhtml:p>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74314",
                                                                    "artifact_title": "Ensure the log destinations are set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_destination;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^.+$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_destination"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_the_logging_collector_is_enabled",
                                                    "title": "Ensure the logging collector is enabled",
                                                    "description": "<xhtml:p>  The logging collector is a background process that captures log messages sent to   <xhtml:span class=\"inline_block\">    stderr  </xhtml:span>   and redirects them into log files. The   <xhtml:span class=\"inline_block\">    logging_collector  </xhtml:span>   setting must be enabled in order for this process to run. It can only be set at server start.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Activate audit logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "true",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Log Settings Support Appropriate Log Entry Formatting",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  The logging collector approach is often more useful than logging to   <xhtml:span class=\"inline_block\">    syslog  </xhtml:span>  , since some types of messages might not appear in   <xhtml:span class=\"inline_block\">    syslog  </xhtml:span>   output. One common example is dynamic-linker failure message; another may be error messages produced by scripts such as   <xhtml:span class=\"inline_block\">    archive_command  </xhtml:span>  .</xhtml:p><xhtml:p>  <xhtml:strong>    Note:  </xhtml:strong>   This setting   <xhtml:em>    must  </xhtml:em>   be enabled when   <xhtml:span class=\"inline_block\">    log_destination  </xhtml:span>   is either 'stderr' or 'csvlog' and for certain other logging parameters to take effect.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set logging_collector = 'on';      <br/>      ALTER SYSTEM    </xhtml:code>    <xhtml:p>      Unfortunately, this setting can only be changed at server (re)start. As root, restart the PostgreSQL service for this change to take effect:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ service postgresql-9.6 restart      <br/>      Stopping postgresql-9.6 service:                           [  OK  ]      <br/>      Starting postgresql-9.6 service:                           [  OK  ]    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74315",
                                                                    "artifact_title": "Ensure the logging collector is enabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show logging_collector;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)on$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "logging_collector"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_the_log_file_destination_directory_is_set_correctly",
                                                    "title": "Ensure the log file destination directory is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_directory  </xhtml:span>   setting specifies the destination directory for log files when   <xhtml:span class=\"inline_block\">    log_destination  </xhtml:span>   is   <xhtml:span class=\"inline_block\">    stderr  </xhtml:span>   or   <xhtml:span class=\"inline_block\">    csvlog  </xhtml:span>  . It can be specified as relative to the cluster data directory (  <xhtml:span class=\"inline_block\">    $PGDATA  </xhtml:span>  ) or as an absolute path.   <xhtml:span class=\"inline_block\">    log_directory  </xhtml:span>   should be set according to your organization's logging policy.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Activate audit logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "true",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Log Settings Support Appropriate Log Entry Formatting",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If   <xhtml:span class=\"inline_block\">    log_directory  </xhtml:span>   is not set, it is interpreted as the absolute path   <xhtml:span class=\"inline_block\">    '/'  </xhtml:span>   and PostgreSQL will attempt to write its logs there (and typically fail due to a lack of permissions to that directory). This parameter should be set to direct the logs into the appropriate directory location as defined by your organization's logging policy.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_directory='logs';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)      <br/>      postgres=# show log_directory;      <br/>       log_directory      <br/>      ---------------      <br/>       logs      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      <xhtml:strong>        Note:      </xhtml:strong>       The use of       <xhtml:span class=\"inline_block\">        logs      </xhtml:span>      , above, is an example. This should be set to an appropriate path as defined by your organization's logging requirements.    </xhtml:p>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74316",
                                                                    "artifact_title": "Ensure the log file destination directory is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_directory"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^.*\\/?(?i)pg\\_log$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_directory"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.5_Ensure_the_filename_pattern_for_log_files_is_set_correctly",
                                                    "title": "Ensure the filename pattern for log files is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   setting specifies the filename pattern for log files. The value for   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   should match your organization's logging policy.</xhtml:p><xhtml:p>  The value is treated as a   <xhtml:span class=\"inline_block\">    strftime  </xhtml:span>   pattern, so   <xhtml:span class=\"inline_block\">    %-escapes  </xhtml:span>   can be used to specify time-varying filenames. The supported   <xhtml:span class=\"inline_block\">    %-escapes  </xhtml:span>   are similar to those listed in the Open Group's   <xhtml:span class=\"inline_block\">    strftime  </xhtml:span>   specification. If you specify a filename without escapes, you should plan to use a log rotation utility to avoid eventually filling the partition that contains   <xhtml:span class=\"inline_block\">    log_directory  </xhtml:span>  . If there are any time-zone-dependent   <xhtml:span class=\"inline_block\">    %-escapes  </xhtml:span>  , the computation is done in the zone specified by   <xhtml:span class=\"inline_block\">    log_timezone  </xhtml:span>  . Also, the system's   <xhtml:span class=\"inline_block\">    strftime  </xhtml:span>   is not used directly, so platform-specific (nonstandard) extensions do not work.</xhtml:p><xhtml:p>  If CSV-format output is enabled in   <xhtml:span class=\"inline_block\">    log_destination  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    .csv  </xhtml:span>   will be appended to the log filename. (If   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   ends in   <xhtml:span class=\"inline_block\">    .log  </xhtml:span>  , the suffix is replaced instead.)</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Activate audit logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "true",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Log Settings Support Appropriate Log Entry Formatting",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   is not set, then the value of   <xhtml:span class=\"inline_block\">    log_directory  </xhtml:span>   is appended to an empty string and PostgreSQL will fail to start as it will try to write to a directory instead of a file.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://man7.org/linux/man-pages/man3/strftime.3.html"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_filename='postgresql-%Y%m%d.log';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)      <br/>      postgres=# show log_filename;      <br/>         log_filename      <br/>      -------------------      <br/>       postgresql-%Y%m%d.log      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      <xhtml:strong>        Note:      </xhtml:strong>       In this example, a new logfile will be created for each day (e.g. postgresql-20180901.log)    </xhtml:p>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74317",
                                                                    "artifact_title": "Ensure the filename pattern for log files is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_filename;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^.+([-_]*%[a-eA-EFghGHIjklmMnOpr-zR-Z+%][-_]*)+\\.(?i)log$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_filename"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.6_Ensure_the_log_file_permissions_are_set_correctly",
                                                    "title": "Ensure the log file permissions are set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_file_mode  </xhtml:span>   setting determines the file permissions for log files when   <xhtml:span class=\"inline_block\">    logging_collector  </xhtml:span>   is enabled. The parameter value is expected to be a numeric mode specification in the form accepted by the   <xhtml:span class=\"inline_block\">    chmod  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    umask  </xhtml:span>   system calls. (To use the customary octal format, the number must start with a   <xhtml:span class=\"inline_block\">    0  </xhtml:span>   (zero).)</xhtml:p><xhtml:p>  The permissions should be set to allow only the necessary access to authorized personnel. In most cases the best setting is   <xhtml:span class=\"inline_block\">    0600  </xhtml:span>  , so that only the server owner can read or write the log files. The other commonly useful setting is   <xhtml:span class=\"inline_block\">    0640  </xhtml:span>  , allowing members of the owner's group to read the files, although to make use of that, you will need to alter the   <xhtml:span class=\"inline_block\">    log_directory  </xhtml:span>   setting to store the log files outside the cluster data directory.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Protect Information through  Access Control Lists",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:14:6",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "true",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Data",
                                                                    "securityFunction": "Protect"
                                                                },
                                                                {
                                                                    "title": "Protect Information With Access Control Lists",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:14:4",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Log files often contain sensitive data. Allowing unnecessary access to log files may inadvertently expose sensitive data to unauthorized personnel.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting (with the example assuming a desired value of       <xhtml:span class=\"inline_block\">        0600      </xhtml:span>      ):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_file_mode = '0600';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)      <br/>      postgres=# show log_file_mode;      <br/>       log_file_mode      <br/>      ---------------      <br/>       0600      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74318",
                                                                    "artifact_title": "Ensure the log file permissions are set to '0600'",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_file_mode;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^06[04]0$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_file_mode"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.7_Ensure_log_truncate_on_rotation_is_enabled",
                                                    "title": "Ensure 'log_truncate_on_rotation' is enabled",
                                                    "description": "<xhtml:p>  Enabling the   <xhtml:span class=\"inline_block\">    log_truncate_on_rotation  </xhtml:span>   setting when   <xhtml:span class=\"inline_block\">    logging_collector  </xhtml:span>   is enabled causes PostgreSQL to truncate (overwrite) existing log files with the same name during log rotation instead of appending to them. For example, using this setting in combination with a   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   setting value like   <xhtml:span class=\"inline_block\">    postgresql-%H.log  </xhtml:span>   would result in generating 24 hourly log files and then cyclically overwriting them:</xhtml:p><xhtml:code class=\"code_block\">  postgresql-00.log  <br/>  postgresql-01.log  <br/>  [...]  <br/>  postgresql-23.log</xhtml:code><xhtml:p>  <xhtml:strong>    Note:  </xhtml:strong>   Truncation will occur   <xhtml:strong>    <xhtml:em>      only    </xhtml:em>  </xhtml:strong>   when a new file is being opened due to time-based rotation, not during server startup or size-based rotation (see later in this benchmark for size-based rotation details).</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Ensure adequate storage for logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:4",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive)",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this setting is disabled, pre-existing log files will be appended to if   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   is configured in such a way that static names are generated.</xhtml:p><xhtml:p>  Enabling or disabling the truncation should only be decided when   <xhtml:strong>    also  </xhtml:strong>   considering the value of   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    log_rotation_age  </xhtml:span>  /  <xhtml:span class=\"inline_block\">    log_rotation_size  </xhtml:span>  . Some examples to illustrate the interaction between these settings:</xhtml:p><xhtml:code class=\"code_block\">  # truncation is moot, as each rotation gets a unique filename (postgresql-20180605.log)  <br/>  log_truncate_on_rotation = on  <br/>  log_filename = 'postgresql-%Y%m%d.log'  <br/>  log_rotation_age = '1d'  <br/>  log_rotation_size = 0</xhtml:code><xhtml:code class=\"code_block\">  # truncation every hour, losing log data every hour until the date changes  <br/>  log_truncate_on_rotation = on  <br/>  log_filename = 'postgresql-%Y%m%d.log'  <br/>  log_rotation_age = '1h'  <br/>  log_rotation_size = 0</xhtml:code><xhtml:code class=\"code_block\">  # no truncation if the date changed while generating 100M of log data, truncation otherwise  <br/>  log_truncate_on_rotation = on  <br/>  log_filename = 'postgresql-%Y%m%d.log'  <br/>  log_rotation_age = '0'  <br/>  log_rotation_size = '100M'</xhtml:code>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_truncate_on_rotation = 'off';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)      <br/>      postgres=# show log_truncate_on_rotation;      <br/>       log_truncate_on_rotation      <br/>      --------------------------      <br/>       off      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74319",
                                                                    "artifact_title": "Ensure 'log_truncate_on_rotation' is set to 'off'",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_truncate_on_rotation;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)off$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_truncate_on_rotation"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.8_Ensure_the_maximum_log_file_lifetime_is_set_correctly",
                                                    "title": "Ensure the maximum log file lifetime is set correctly",
                                                    "description": "<xhtml:p>  When   <xhtml:span class=\"inline_block\">    logging_collector  </xhtml:span>   is enabled, the   <xhtml:span class=\"inline_block\">    log_rotation_age  </xhtml:span>   parameter determines the maximum lifetime of an individual log file (depending on the value of   <xhtml:span class=\"inline_block\">    log_filename  </xhtml:span>  ). After this many minutes have elapsed, a new log file will be created via automatic log file rotation. Current best practices advise log rotation   <xhtml:em>    at least  </xhtml:em>   daily, but your organization's logging policy should dictate your rotation schedule.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Ensure adequate storage for logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:4",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive)",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Log rotation is a standard best practice for log management.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting (in this example, setting it to one hour):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_rotation_age='1h';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74320",
                                                                    "artifact_title": "Ensure the maximum log file lifetime is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_rotation_age;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^[1-9][0-9]*(hr|d|m)$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_rotation_age"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.9_Ensure_the_maximum_log_file_size_is_set_correctly",
                                                    "title": "Ensure the maximum log file size is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_rotation_size  </xhtml:span>   setting determines the maximum size of an individual log file. Once the maximum size is reached, automatic log file rotation will occur.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Ensure adequate storage for logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:4",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                },
                                                                {
                                                                    "title": "Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive)",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "null",
                                                                        "ig1": "null",
                                                                        "ig2": "null"
                                                                    },
                                                                    "assetType": "",
                                                                    "securityFunction": ""
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this is set to zero, size-triggered creation of new log files is disabled. This will prevent automatic log file rotation when files become too large, which could put log data at increased risk of loss (unless age-based rotation is configured).</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting (in this example, setting it to 1GB):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_rotation_size = '1GB';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74321",
                                                                    "artifact_title": "Ensure the maximum log file size is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_rotation_size;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^[1-9][0-9]*(?i)[GM]B$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_rotation_size"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.10_Ensure_the_correct_syslog_facility_is_selected",
                                                    "title": "Ensure the correct syslog facility is selected",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    syslog_facility  </xhtml:span>   setting specifies the syslog \"facility\" to be used when logging to   <xhtml:span class=\"inline_block\">    syslog  </xhtml:span>   is enabled. You can choose from any of the 'local' facilities:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL0    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL1    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL2    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL3    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL4    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL5    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL6    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOCAL7    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  Your organization's logging policy should dictate which facility to use based on the   <xhtml:span class=\"inline_block\">    syslog  </xhtml:span>   daemon in use.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Activate audit logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:2",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "true",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If not set to the appropriate facility, the PostgreSQL log messages may be intermingled with other applications' log messages, incorrectly routed, or potentially dropped (depending on your   <xhtml:span class=\"inline_block\">    syslog  </xhtml:span>   configuration).</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://tools.ietf.org/html/rfc3164#section-4.1.1"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting (in this example, setting it to the       <xhtml:span class=\"inline_block\">        LOCAL1      </xhtml:span>       facility):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set syslog_facility = 'LOCAL1';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74322",
                                                                    "artifact_title": "Ensure the correct syslog facility is selected",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show syslog_facility;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)local[0-7]$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "syslog_facility"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.11_Ensure_the_program_name_for_PostgreSQL_syslog_messages_is_correct",
                                                    "title": "Ensure the program name for PostgreSQL syslog messages is correct",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    syslog_ident  </xhtml:span>   setting specifies the program name used to identify PostgreSQL messages in syslog logs. An example of a possible program name is \"postgres\".</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this is not set correctly, it may be difficult or impossible to distinguish PostgreSQL messages from other messages in syslog logs.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://tools.ietf.org/html/rfc3164#section-4.1.3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting (in this example, assuming a program name of \"pg96\"):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set syslog_ident = 'pg96';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)      <br/>      postgres=# show syslog_ident;      <br/>       syslog_ident      <br/>      --------------      <br/>       pg96      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74323",
                                                                    "artifact_title": "Ensure the program name for PostgreSQL syslog messages is correct",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show syslog_ident;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^.+$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "syslog_ident"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.12_Ensure_the_correct_messages_are_written_to_the_server_log",
                                                    "title": "Ensure the correct messages are written to the server log",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_min_messages  </xhtml:span>   setting specifies the message levels that are written to the server log. Each level includes all the levels that follow it. The later the level, the fewer messages are sent.</xhtml:p><xhtml:p>  Valid values are:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG5    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG4    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG3    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG2    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG1    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      INFO    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      NOTICE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      WARNING    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      ERROR    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOG    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      FATAL    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      PANIC    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  <xhtml:span class=\"inline_block\">    WARNING  </xhtml:span>   is considered the best practice unless indicated otherwise by your organization's logging policy.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Ensure adequate storage for logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:4",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this is not set to the correct value, too many messages or too few messages may be written to the server log.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) as superuser to remediate this setting (in this example, to set it to       <xhtml:span class=\"inline_block\">        warning      </xhtml:span>      ):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_min_messages = 'warning';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74325",
                                                                    "artifact_title": "Ensure the correct messages are written to the server log",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_min_messages;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)debug+[1-5]|info|log|notice|warning|error|fatal|panic$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_min_messages"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.13_Ensure_the_correct_SQL_statements_generating_errors_are_recorded",
                                                    "title": "Ensure the correct SQL statements generating errors are recorded",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_min_error_statement  </xhtml:span>   setting causes all SQL statements generating errors at or above the specified severity level to be recorded in the server log. Each level includes all the levels that follow it. The later the level, the fewer messages are recorded. Valid values are:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG5    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG4    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG3    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG2    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEBUG1    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      INFO    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      NOTICE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      WARNING    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      ERROR    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      LOG    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      FATAL    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      PANIC    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  <xhtml:strong>    Note:  </xhtml:strong>   To effectively turn off logging of failing statements, set this parameter to   <xhtml:span class=\"inline_block\">    PANIC  </xhtml:span>  .</xhtml:p><xhtml:p>  <xhtml:span class=\"inline_block\">    ERROR  </xhtml:span>   is considered the best practice setting. Changes should only be made in accordance with your organization's logging policy.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Ensure adequate storage for logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:4",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this is not set to the correct value, too many erring SQL statements or too few erring SQL statements may be written to the server log.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) as superuser to remediate this setting (in the example, to       <xhtml:span class=\"inline_block\">        error      </xhtml:span>      ):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_min_error_statement = 'error';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74326",
                                                                    "artifact_title": "Ensure the correct SQL statements generating errors are recorded",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_min_error_statement;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)debug+[1-5]|info|log|notice|warning|error|fatal|panic$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_min_error_statement"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.14_Ensure_debug_print_parse_is_disabled",
                                                    "title": "Ensure 'debug_print_parse' is disabled",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    debug_print_parse  </xhtml:span>   setting enables printing the resulting parse tree for each executed query. These messages are emitted at the   <xhtml:span class=\"inline_block\">    LOG  </xhtml:span>   message level. Unless directed otherwise by your organization's logging policy, it is recommended this setting be disabled by setting it to   <xhtml:span class=\"inline_block\">    off  </xhtml:span>  .</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": {
                                                                "implementationGroup": null,
                                                                "title": null,
                                                                "urn": null,
                                                                "securityFunction": null,
                                                                "assetType": null
                                                            },
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6"
                                                                },
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Enabling any of the   <xhtml:span class=\"inline_block\">    DEBUG  </xhtml:span>   printing variables may cause the logging of sensitive information that would otherwise be omitted based on the configuration of the other logging settings.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set debug_print_parse='off';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74328",
                                                                    "artifact_title": "Ensure 'debug_print_parse' is disabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show debug_print_parse;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)off$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "debug_print_parse"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.15_Ensure_debug_print_rewritten_is_disabled",
                                                    "title": "Ensure 'debug_print_rewritten' is disabled",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    debug_print_rewritten  </xhtml:span>   setting enables printing the query rewriter output for each executed query. These messages are emitted at the   <xhtml:span class=\"inline_block\">    LOG  </xhtml:span>   message level. Unless directed otherwise by your organization's logging policy, it is recommended this setting be disabled by setting it to   <xhtml:span class=\"inline_block\">    off  </xhtml:span>  .</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": {
                                                                "implementationGroup": null,
                                                                "title": null,
                                                                "urn": null,
                                                                "securityFunction": null,
                                                                "assetType": null
                                                            },
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6"
                                                                },
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Enabling any of the   <xhtml:span class=\"inline_block\">    DEBUG  </xhtml:span>   printing variables may cause the logging of sensitive information that would otherwise be omitted based on the configuration of the other logging settings.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to disable this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set debug_print_rewritten = 'off';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74329",
                                                                    "artifact_title": "Ensure 'debug_print_rewritten' is disabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show debug_print_rewritten;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)off$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "debug_print_rewritten"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.16_Ensure_debug_print_plan_is_disabled",
                                                    "title": "Ensure 'debug_print_plan' is disabled",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    debug_print_plan  </xhtml:span>   setting enables printing the execution plan for each executed query. These messages are emitted at the   <xhtml:span class=\"inline_block\">    LOG  </xhtml:span>   message level. Unless directed otherwise by your organization's logging policy, it is recommended this setting be disabled by setting it to   <xhtml:span class=\"inline_block\">    off  </xhtml:span>  .</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": {
                                                                "implementationGroup": null,
                                                                "title": null,
                                                                "urn": null,
                                                                "securityFunction": null,
                                                                "assetType": null
                                                            },
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6"
                                                                },
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Enabling any of the   <xhtml:span class=\"inline_block\">    DEBUG  </xhtml:span>   printing variables may cause the logging of sensitive information that would otherwise be omitted based on the configuration of the other logging settings.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to disable this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set debug_print_plan = 'off';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74330",
                                                                    "artifact_title": "Ensure 'debug_print_plan' is disabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show debug_print_plan ;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)off$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "debug_print_plan"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.17_Ensure_debug_pretty_print_is_enabled",
                                                    "title": "Ensure 'debug_pretty_print' is enabled",
                                                    "description": "<xhtml:p>  Enabling   <xhtml:span class=\"inline_block\">    debug_pretty_print  </xhtml:span>   indents the messages produced by   <xhtml:span class=\"inline_block\">    debug_print_parse  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    debug_print_rewritten  </xhtml:span>  , or   <xhtml:span class=\"inline_block\">    debug_print_plan  </xhtml:span>   making them significantly easier to read.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this setting is disabled, the \"compact\" format is used instead, significantly reducing readability of the   <xhtml:span class=\"inline_block\">    DEBUG  </xhtml:span>   statement log messages.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to enable this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set debug_pretty_print = 'on';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        Be advised that the aforementioned         <xhtml:span class=\"inline_block\">          DEBUG        </xhtml:span>         printing options are         <xhtml:strong>          disabled        </xhtml:strong>        , but if your organizational logging policy requires them to be         <xhtml:span class=\"inline_block\">          on        </xhtml:span>         then this option comes into play.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74331",
                                                                    "artifact_title": "Ensure 'debug_pretty_print' is enabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show debug_pretty_print ;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)on$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "debug_pretty_print"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.18_Ensure_log_connections_is_enabled",
                                                    "title": "Ensure 'log_connections' is enabled",
                                                    "description": "<xhtml:p>  Enabling the   <xhtml:span class=\"inline_block\">    log_connections  </xhtml:span>   setting causes each attempted connection to the server to be logged, as well as successful completion of client authentication. This parameter cannot be changed after session start.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  PostgreSQL does not maintain an internal record of attempted connections to the database for later auditing. It is only by enabling the logging of these attempts that one can determine if unexpected attempts are being made.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to enable this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_connections = 'on';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74333",
                                                                    "artifact_title": "Ensure 'log_connections' is enabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_connections ;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)on$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_connections"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.19_Ensure_log_disconnections_is_enabled",
                                                    "title": "Ensure 'log_disconnections' is enabled",
                                                    "description": "<xhtml:p>  Enabling the   <xhtml:span class=\"inline_block\">    log_disconnections  </xhtml:span>   setting logs the end of each session, including session duration. This parameter cannot be changed after session start.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  PostgreSQL does not maintain the beginning or ending of a connection internally for later review. It is only by enabling the logging of these that one can examine connections for failed attempts, 'over long' duration, or other anomalies.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to enable this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_disconnections = 'on';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74334",
                                                                    "artifact_title": "Ensure 'log_disconnections' is enabled",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_disconnections ;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "only_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)on$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_disconnections"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.20_Ensure_log_error_verbosity_is_set_correctly",
                                                    "title": "Ensure 'log_error_verbosity' is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_error_verbosity  </xhtml:span>   setting specifies the verbosity (amount of detail) of logged messages. Valid values are:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      TERSE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DEFAULT    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      VERBOSE    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  with each containing the fields of the level above it as well as additional fields.</xhtml:p><xhtml:p>  <xhtml:span class=\"inline_block\">    TERSE  </xhtml:span>   excludes the logging of   <xhtml:span class=\"inline_block\">    DETAIL  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    HINT  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    QUERY  </xhtml:span>  , and   <xhtml:span class=\"inline_block\">    CONTEXT  </xhtml:span>   error information.</xhtml:p><xhtml:p>  <xhtml:span class=\"inline_block\">    VERBOSE  </xhtml:span>   output includes the   <xhtml:span class=\"inline_block\">    SQLSTATE  </xhtml:span>   error code and the source code file name, function name, and line number that generated the error.</xhtml:p><xhtml:p>  The appropriate value should be set based on your organization's logging policy.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  If this is not set to the correct value, too many details or too few details may be logged.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) as superuser to remediate this setting (in this example, to       <xhtml:span class=\"inline_block\">        verbose      </xhtml:span>      ):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_error_verbosity = 'verbose';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74336",
                                                                    "artifact_title": "Ensure 'log_error_verbosity' is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_error_verbosity ;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^(?i)terse|default|verbose$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_error_verbosity"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.21_Ensure_log_hostname_is_set_correctly",
                                                    "title": "Ensure 'log_hostname' is set correctly",
                                                    "description": "<xhtml:p>  Enabling the   <xhtml:span class=\"inline_block\">    log_hostname  </xhtml:span>   setting causes the hostname of the connecting host to be logged   <xhtml:strong>    in addition  </xhtml:strong>   to the host's IP address for connection log messages. Disabling the setting causes only the connecting host's IP address to be logged, and not the hostname. Unless your organization's logging policy requires hostname logging, it is best to disable this setting so as not to incur the overhead of DNS resolution for each statement that is logged.</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": {
                                                                "implementationGroup": null,
                                                                "title": null,
                                                                "urn": null,
                                                                "securityFunction": null,
                                                                "assetType": null
                                                            },
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6"
                                                                },
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Depending on your hostname resolution setup, enabling this setting might impose a non-negligible performance penalty. Additionally, the IP addresses that are logged can be resolved to their DNS names when reviewing the logs (unless dynamic host names are being used as part of your DHCP setup).</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting (in this example, to       <xhtml:span class=\"inline_block\">        off      </xhtml:span>      ):    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_hostname='off';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74337",
                                                                    "artifact_title": "Ensure 'log_hostname' is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_hostname;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "off"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_hostname"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "equals"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.22_Ensure_log_line_prefix_is_set_correctly",
                                                    "title": "Ensure 'log_line_prefix' is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_line_prefix  </xhtml:span>   setting specifies a   <xhtml:span class=\"inline_block\">    printf  </xhtml:span>  -style string that is prefixed to each log line. If blank, no prefix is used. You should configure this as recommended by the   <xhtml:a href=\"https://pgbadger.darold.net/\">    pgBadger  </xhtml:a>   development team unless directed otherwise by your organization's logging policy. The default value is   <xhtml:span class=\"inline_block\">    &lt; %m &gt;  </xhtml:span>  .</xhtml:p><xhtml:p>  <xhtml:span class=\"inline_block\">    %  </xhtml:span>   characters begin \"escape sequences\" that are replaced with status information as outlined below. Unrecognized escapes are ignored. Other characters are copied straight to the log line. Some escapes are only recognized by session processes and will be treated as empty by background processes such as the main server process. Status information may be aligned either left or right by specifying a numeric literal after the   <xhtml:span class=\"inline_block\">    %  </xhtml:span>   and before the option. A negative value will cause the status information to be padded on the right with spaces to give it a minimum width, whereas a positive value will pad on the left. Padding can be useful to aid human readability in log files.</xhtml:p><xhtml:p>  The default is   <xhtml:span class=\"inline_block\">    &lt; %m &gt;  </xhtml:span>  , but any of the following escape sequences can be used:</xhtml:p><xhtml:code class=\"code_block\">  Escape  Effect                                            Session only  <br/>  %a      Application name                                  yes  <br/>  %u      User name                                         yes  <br/>  %d      Database name                                     yes  <br/>  %r      Remote host name or IP address, and remote port   yes  <br/>  %h      Remote host name or IP address                    yes  <br/>  %p      Process ID                                        no  <br/>  %t      Time stamp without milliseconds                   no  <br/>  %m      Time stamp with milliseconds                      no  <br/>  %i      Command tag: type of session's current command    yes  <br/>  %e      SQLSTATE error code                               no  <br/>  %c      Session ID: see below                             no  <br/>  %l      Number of the log line for each session   <br/>          or process, starting at 1                         no  <br/>  %s      Process start time stamp                          no  <br/>  %v      Virtual transaction ID (backendID/localXID)       no  <br/>  %x      Transaction ID (0 if none is assigned)            no  <br/>  %q      Produces no output, but tells non-session   <br/>          processes to stop at this point in the string;  <br/>          ignored by session processes                      no  <br/>  %%      Literal %</xhtml:code>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Properly setting   <xhtml:span class=\"inline_block\">    log_line_prefix  </xhtml:span>   allows for adding additional information to each log entry (such as the user, or the database). Said information may then be of use in auditing or security reviews.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://pgbadger.darold.net/"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_line_prefix = '%t [%p]: [%l-1] db=%d,user=%u,app=%a,client=%h ';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74338",
                                                                    "artifact_title": "Ensure 'log_line_prefix' is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_line_prefix;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^<\\s*\\%[audrhptmieclsvxq\\%\\s]+\\s*>\\*$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_line_prefix"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.23_Ensure_log_statement_is_set_correctly",
                                                    "title": "Ensure 'log_statement' is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_statement  </xhtml:span>   setting specifies the types of SQL statements that are logged. Valid values are:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      none    </xhtml:span>     (off)  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      ddl    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      mod    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      all    </xhtml:span>     (all statements)  </xhtml:li></xhtml:ul><xhtml:p>  It is recommended this be set to   <xhtml:span class=\"inline_block\">    ddl  </xhtml:span>   unless otherwise directed by your organization's logging policy.</xhtml:p><xhtml:p>  <xhtml:span class=\"inline_block\">    ddl  </xhtml:span>   logs all data definition statements:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      CREATE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      ALTER    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DROP    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  <xhtml:span class=\"inline_block\">    mod  </xhtml:span>   logs all   <xhtml:span class=\"inline_block\">    ddl  </xhtml:span>   statements, plus data-modifying statements:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      INSERT    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      UPDATE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      DELETE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      TRUNCATE    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      COPY FROM    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  (  <xhtml:span class=\"inline_block\">    PREPARE  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    EXECUTE  </xhtml:span>  , and   <xhtml:span class=\"inline_block\">    EXPLAIN ANALYZE  </xhtml:span>   statements are also logged if their contained command is of an appropriate type.)</xhtml:p><xhtml:p>  For clients using extended query protocol, logging occurs when an Execute message is received, and values of the Bind parameters are included (with any embedded single-quote marks doubled).</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Setting   <xhtml:span class=\"inline_block\">    log_statement  </xhtml:span>   to align with your organization's security and logging policies facilitates later auditing and review of database activities.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) as superuser to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_statement='ddl';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74340",
                                                                    "artifact_title": "Ensure 'log_statement' is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_statement;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^ddl|mod|all$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_statement"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "Rules": [
                                            {
                                                "Rule": {
                                                    "id": "xccdf_org.cisecurity.benchmarks_rule_3.1.24_Ensure_log_timezone_is_set_correctly",
                                                    "title": "Ensure 'log_timezone' is set correctly",
                                                    "description": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    log_timezone  </xhtml:span>   setting specifies the time zone to use in timestamps within log messages. This value is cluster-wide, so that all sessions will report timestamps consistently. Unless directed otherwise by your organization's logging policy, set this to either   <xhtml:span class=\"inline_block\">    GMT  </xhtml:span>   or   <xhtml:span class=\"inline_block\">    UTC  </xhtml:span>  .</xhtml:p>",
                                                    "metadata": {
                                                        "xmls:controls": "http://cisecurity.org/controls",
                                                        "framework": {
                                                            "urn": "urn:cisecurity.org:controls:6.0",
                                                            "safeguard": [
                                                                {
                                                                    "title": "Enable Detailed Logging",
                                                                    "urn": "urn:cisecurity.org:controls:7.0:6:3",
                                                                    "implementationGroups": {
                                                                        "ig3": "true",
                                                                        "ig1": "null",
                                                                        "ig2": "true"
                                                                    },
                                                                    "assetType": "Network",
                                                                    "securityFunction": "Detect"
                                                                }
                                                            ],
                                                            "control": [
                                                                {
                                                                    "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                                    "urn": "urn:cisecurity.org:controls:6.0:6"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "rationale": "<xhtml:p>  Log entry timestamps should be configured for an appropriate time zone as defined by your organization's logging policy to ensure a lack of confusion around when a logged event occurred.</xhtml:p>",
                                                    "idents": [
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v6.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                                        },
                                                        {
                                                            "system": "http://cisecurity.org/20-cc/v7.0",
                                                            "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3"
                                                        },
                                                        {
                                                            "system": "http://cce.mitre.org",
                                                            "controlURI": "",
                                                            "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-logging.html"
                                                        }
                                                    ],
                                                    "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Execute the following SQL statement(s) to remediate this setting:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter system set log_timezone = 'GMT';      <br/>      ALTER SYSTEM      <br/>      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>  </xhtml:p></xhtml:div>",
                                                    "checks": {
                                                        "and": [
                                                            {
                                                                "artifact-expression": {
                                                                    "artifact-unique-id": "74342",
                                                                    "artifact_title": "Ensure 'log_timezone' is set correctly",
                                                                    "artifact": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "engine",
                                                                                    "dt": "string",
                                                                                    "value": "postgre"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "sql",
                                                                                    "dt": "string",
                                                                                    "value": "show log_timezone;"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "version",
                                                                                    "dt": "string",
                                                                                    "value": "9.6"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_str",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "prepend_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "append_type",
                                                                                    "dt": "string",
                                                                                    "value": ""
                                                                                }
                                                                            }
                                                                        ]
                                                                    },
                                                                    "test": {
                                                                        "type": "independent.sql57_v1",
                                                                        "parameters": [
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check_existence",
                                                                                    "dt": "string",
                                                                                    "value": "at_least_one_exists"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "check",
                                                                                    "dt": "string",
                                                                                    "value": "all"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value",
                                                                                    "dt": "string",
                                                                                    "value": "^GMT|UTC$"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "value_data_type",
                                                                                    "dt": "string",
                                                                                    "value": "string"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_name",
                                                                                    "dt": "string",
                                                                                    "value": "log_timezone"
                                                                                }
                                                                            },
                                                                            {
                                                                                "parameter": {
                                                                                    "name": "field_operation",
                                                                                    "dt": "string",
                                                                                    "value": "pattern match"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_the_PostgreSQL_Audit_Extension_pgAudit_is_enabled",
                                        "title": "Ensure the PostgreSQL Audit Extension (pgAudit) is enabled",
                                        "description": "<xhtml:p>  The PostgreSQL Audit Extension (  <xhtml:a href=\"https://www.pgaudit.org/\">    pgAudit  </xhtml:a>  ) provides detailed session and/or object audit logging via the standard PostgreSQL logging facility. The goal of pgAudit is to provide PostgreSQL users with the capability to produce audit logs often required to comply with government, financial, or ISO certifications.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Activate audit logging",
                                                        "urn": "urn:cisecurity.org:controls:7.0:6:2",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Network",
                                                        "securityFunction": "Detect"
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Maintenance, Monitoring, and Analysis of Audit Logs",
                                                        "urn": "urn:cisecurity.org:controls:6.0:6"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Basic statement logging can be provided by the standard logging facility with   <xhtml:span class=\"inline_block\">    log_statement = all  </xhtml:span>  . This is acceptable for monitoring and other uses but does not provide the level of detail generally required for an audit. It is not enough to have a list of all the operations performed against the database, it must also be possible to find particular statements that are of interest to an auditor. The standard logging facility shows what the user requested, while pgAudit focuses on the details of what happened while the database was satisfying the request.</xhtml:p><xhtml:p>  When logging   <xhtml:span class=\"inline_block\">    SELECT  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    DML  </xhtml:span>   statements, pgAudit can be configured to log a separate entry for each relation referenced in a statement. No parsing is required to find all statements that touch a particular table. In fact, the goal is that the statement text is provided primarily for deep forensics and should not be required for an audit.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/6"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.pgaudit.org/"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      To install and enable pgAudit, simply install the appropriate rpm from the PGDG repo:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ yum -y install pgaudit_96      <br/>      Loaded plugins: fastestmirror      <br/>      Setting up Install Process      <br/>      Loading mirror speeds from cached hostfile      <br/>       * base: mirror.vtti.vt.edu      <br/>       * extras: mirror.cogentco.com      <br/>       * updates: bay.uchicago.edu      <br/>      Resolving Dependencies      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package pgaudit_96.x86_64 0:1.0.4-1.rhel6 will be installed      <br/>      --&gt; Finished Dependency Resolution      <br/>      <br/>      Dependencies Resolved      <br/>      <br/>      ================================================================================      <br/>       Package            Arch           Version                 Repository      Size      <br/>      ================================================================================      <br/>      Installing:      <br/>       pgaudit_96         x86_64         1.0.4-1.rhel6           pgdg96          18 k      <br/>      <br/>      Transaction Summary      <br/>      ================================================================================      <br/>      Install       1 Package(s)      <br/>      <br/>      Total download size: 18 k      <br/>      Installed size: 41 k      <br/>      Downloading Packages:      <br/>      pgaudit_96-1.0.4-1.rhel6.x86_64.rpm                      |  18 kB     00:00      <br/>      Running rpm_check_debug      <br/>      Running Transaction Test      <br/>      Transaction Test Succeeded      <br/>      Running Transaction      <br/>        Installing : pgaudit_96-1.0.4-1.rhel6.x86_64                              1/1      <br/>        Verifying  : pgaudit_96-1.0.4-1.rhel6.x86_64                              1/1      <br/>      <br/>      Installed:      <br/>        pgaudit_96.x86_64 0:1.0.4-1.rhel6      <br/>      <br/>      Complete!    </xhtml:code>    <xhtml:p>      pgAudit is now installed and ready to be configured. Next, we need to alter the       <xhtml:span class=\"inline_block\">        postgresql.conf      </xhtml:span>       configuration file to:    </xhtml:p>    <xhtml:ul>      <xhtml:li>        enable pgAudit as an extension in the         <xhtml:span class=\"inline_block\">          shared_preload_libraries        </xhtml:span>         parameter      </xhtml:li>      <xhtml:li>        indicate which classes of statements we want to log via the         <xhtml:span class=\"inline_block\">          pgaudit.log        </xhtml:span>         parameter      </xhtml:li>    </xhtml:ul>    <xhtml:p>      and, finally, restart the PostgreSQL service:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ vi ${PGDATA}/postgresql.conf    </xhtml:code>    <xhtml:p>      Find the       <xhtml:span class=\"inline_block\">        shared_preload_libraries      </xhtml:span>       entry, and add 'pgaudit' to it (preserving any existing entries):    </xhtml:p>    <xhtml:code class=\"code_block\">      shared_preload_libraries = 'pgaudit'      <br/>      <br/>      OR      <br/>      <br/>      shared_preload_libraries = 'pgaudit,somethingelse'    </xhtml:code>    <xhtml:p>      Now, add a new       <xhtml:span class=\"inline_block\">        pgaudit      </xhtml:span>      -specific entry:    </xhtml:p>    <xhtml:code class=\"code_block\">      # for this example we are logging the ddl and write operations      <br/>      pgaudit.log='ddl,write'    </xhtml:code>    <xhtml:p>      Restart the PostgreSQL server for changes to take affect:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ service postgresql-9.6 restart      <br/>      Stopping postgresql-9.6 service:                           [  OK  ]      <br/>      Starting postgresql-9.6 service:                           [  OK  ]    </xhtml:code>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        Depending on settings, it is possible for pgAudit to generate an         <xhtml:em>          enormous volume of logging        </xhtml:em>        . Be careful to determine exactly what needs to be audit logged in your environment to avoid logging too much.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74312",
                                                        "artifact_title": "Ensure the PostgreSQL Audit Extension (pgAudit) is enabled",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "show shared_preload_libraries;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": "pgaudit"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": "shared_preload_libraries"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                },
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74313",
                                                        "artifact_title": "Check if audit.log exists",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "show audit.log;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_4_User_Access_and_Authorization",
                    "title": "User Access and Authorization",
                    "description": "<xhtml:p>  The capability to use database resources at a given level, or user authorization rules, allows for user manipulation of the various parts of the PostgreSQL database. These authorizations must be structured to block unauthorized use and/or corruption of vital data and services by setting restrictions on user capabilities.</xhtml:p>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_sudo_is_configured_correctly",
                                        "title": "Ensure sudo is configured correctly",
                                        "description": "<xhtml:p>  It is common to have more than one authorized individual administering the PostgreSQL service at the Operating System level. It is also quite common to permit login privileges to individuals on a PostgreSQL host who otherwise are not authorized to access the server's data cluster and files. Administering the PostgreSQL data cluster, as opposed to its data, is to be accomplished via a localhost login of a regular UNIX user account. Access to the   <xhtml:span class=\"inline_block\">    postgres  </xhtml:span>   superuser account is restricted in such a manner as to interdict unauthorized access.   <xhtml:span class=\"inline_block\">    sudo  </xhtml:span>   satisfies the requirements by escalating ordinary user account privileges as the PostgreSQL RDBMS superuser.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Ensure the Use of Dedicated Administrative Accounts",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4:3",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Users",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Administrators Should Not Directly Log In To A System (i.e. use RunAs/sudo)",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:8",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Without   <xhtml:span class=\"inline_block\">    sudo  </xhtml:span>  , there would not be capabilities to strictly control access to the superuser account and to securely and authoritatively audit its use.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/8"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.sudo.ws/man/1.8.15/sudo.man.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.sudo.ws/man/1.8.17/visudo.man.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      As superuser       <xhtml:span class=\"inline_block\">        root      </xhtml:span>      , execute the command       <xhtml:span class=\"inline_block\">        visudo      </xhtml:span>       to edit the       <xhtml:span class=\"inline_block\">        /etc/sudoers      </xhtml:span>       file so the following line is present:    </xhtml:p>    <xhtml:code class=\"code_block\">      %pg_wheel ALL= /bin/su - postgres    </xhtml:code>    <xhtml:p>      This grants any Operating System user that is a member of the       <xhtml:span class=\"inline_block\">        pg_wheel      </xhtml:span>       group to use       <xhtml:span class=\"inline_block\">        sudo      </xhtml:span>       to become the       <xhtml:span class=\"inline_block\">        postgres      </xhtml:span>       user.    </xhtml:p>    <xhtml:p>      Ensure that all Operating System user's that need such access are members of the group as detailed earlier in this benchmark.    </xhtml:p>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_excessive_administrative_privileges_are_revoked",
                                        "title": "Ensure excessive administrative privileges are revoked",
                                        "description": "<xhtml:p>  With respect to PostgreSQL administrative SQL commands, only superusers should have elevated privileges. PostgreSQL regular, or application, users should not possess the ability to create roles, create new databases, manage replication, or perform any other action deemed privileged . Typically, regular users should only be granted the minimal set of privileges commensurate with managing the application:</xhtml:p><xhtml:ul>  <xhtml:li>    DDL (create table, create view, create index, etc.)  </xhtml:li>  <xhtml:li>    DML (select, insert, update, delete)  </xhtml:li></xhtml:ul><xhtml:p>  Further, it has become best practice to create separate roles for DDL and DML. Given an application called 'payroll', one would create the following users:</xhtml:p><xhtml:ul>  <xhtml:li>    payroll_owner  </xhtml:li>  <xhtml:li>    payroll_user  </xhtml:li></xhtml:ul><xhtml:p>  Any DDL privileges would be granted to the 'payroll_owner' account only, while DML privileges would be given to the 'payroll_user' account only. This prevents accidental creation/altering/dropping of database objects by application code that run as the 'payroll_user' account.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Controlled Use of Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  By not restricting global administrative commands to superusers only, regular users granted excessive privileges may execute administrative commands with unintended and undesirable results.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-revoke.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-createrole.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-alterrole.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      If any regular or application users have been granted excessive administrative rights, those privileges should be removed immediately via the PostgreSQL       <xhtml:span class=\"inline_block\">        ALTER ROLE      </xhtml:span>       SQL command. Using the same example above, the following SQL statements revoke all unnecessary elevated administrative privileges from the regular user       <xhtml:span class=\"inline_block\">        appuser      </xhtml:span>      :    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      postgres      <br/>      $ psql -c \"ALTER ROLE appuser NOSUPERUSER;\"      <br/>      ALTER ROLE      <br/>      $ psql -c \"ALTER ROLE appuser NOCREATEROLE;\"      <br/>      ALTER ROLE      <br/>      $ psql -c \"ALTER ROLE appuser NOCREATEDB;\"      <br/>      ALTER ROLE      <br/>      $ psql -c \"ALTER ROLE appuser NOREPLICATION;\"      <br/>      ALTER ROLE      <br/>      $ psql -c \"ALTER ROLE appuser NOBYPASSRLS;\"      <br/>      ALTER ROLE      <br/>      $ psql -c \"ALTER ROLE appuser NOINHERIT;\"      <br/>      ALTER ROLE    </xhtml:code>    <xhtml:p>      Verify the appuser now passes your check by having no defined Attributes:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      postgres      <br/>      $ psql -c \"\\du appuser\"      <br/>                List of roles      <br/>      Role name | Attributes | Member of      <br/>      ----------+------------+-----------      <br/>      appuser   |            | {}    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_excessive_function_privileges_are_revoked",
                                        "title": "Ensure excessive function privileges are revoked",
                                        "description": "<xhtml:p>  In certain situations, to provide required functionality, PostgreSQL needs to execute internal logic (stored procedures, functions, triggers, etc.) and/or external code modules with elevated privileges. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking the functionality applications/programs, those users are indirectly provided with greater privileges than assigned by their organization. This is known as privilege elevation. Privilege elevation must be utilized only where necessary. Execute privileges for application functions should be restricted to authorized users only.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Controlled Use of Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Ideally, all application source code should be vetted to validate interactions between the application and the logic in the database, but this is usually not possible or feasible with available resources even if the source code is available. The DBA should attempt to obtain assurances from the development organization that this issue has been addressed and should document what has been discovered. The DBA should also inspect all application logic stored in the database (in the form of functions, rules, and triggers) for excessive privileges.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/catalog-pg-proc.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-grant.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-revoke.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-createfunction.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Where possible, revoke       <xhtml:span class=\"inline_block\">        SECURITY DEFINER      </xhtml:span>       on PostgreSQL functions. To change a       <xhtml:span class=\"inline_block\">        SECURITY DEFINER      </xhtml:span>       function to       <xhtml:span class=\"inline_block\">        SECURITY INVOKER      </xhtml:span>      , run the following SQL:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ sudo su - postgres      <br/>      $ psql -c \"ALTER FUNCTION [functionname] SECURITY INVOKER;\"    </xhtml:code>    <xhtml:p>      If it is not possible to revoke       <xhtml:span class=\"inline_block\">        SECURITY DEFINER      </xhtml:span>      , ensure the function can be executed by only the accounts that absolutely need such functionality:    </xhtml:p>    <xhtml:code class=\"code_block\">      REVOKE EXECUTE ON FUNCTION delete_customer(integer,boolean) FROM appreader;      <br/>      REVOKE    </xhtml:code>    <xhtml:p>      Confirm that the       <xhtml:span class=\"inline_block\">        appreader      </xhtml:span>       user may no longer execute the function:    </xhtml:p>    <xhtml:code class=\"code_block\">      SELECT proname, proacl FROM pg_proc WHERE proname = 'delete_customer';      <br/>           proname     |                         proacl      <br/>      -----------------+--------------------------------------------------------      <br/>       delete_customer | {=X/postgres,postgres=X/postgres,appwriter=X/postgres}      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      Based on output above,       <xhtml:span class=\"inline_block\">        appreader=X/postgres      </xhtml:span>       no longer exists in the       <xhtml:span class=\"inline_block\">        proacl      </xhtml:span>       column results returned from query and confirms       <xhtml:span class=\"inline_block\">        appreader      </xhtml:span>       is no longer granted execute privilege on the function.    </xhtml:p>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_excessive_DML_privileges_are_revoked",
                                        "title": "Ensure excessive DML privileges are revoked",
                                        "description": "<xhtml:p>  DML (insert, update, delete) operations at the table level should be restricted to only authorized users. PostgreSQL manages table level DML permissions via the GRANT statement.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Controlled Use of Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Excessive DML grants can lead to unprivileged users changing or deleting information without proper authorization.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-grant.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-revoke.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/functions-info.html#functions-info-access-table"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://wiki.postgresql.org/wiki/A_Guide_to_CVE-2018-1058:_Protect_Your_Search_Path"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://nvd.nist.gov/vuln/detail/CVE-2018-1058"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      If a given database user has been granted excessive DML privileges for a given database table, those privileges should be revoked immediately using the       <xhtml:span class=\"inline_block\">        REVOKE      </xhtml:span>       SQL command.    </xhtml:p>    <xhtml:p>      Continuing with the example above, remove unauthorized grants for       <xhtml:span class=\"inline_block\">        appreader      </xhtml:span>       user using the       <xhtml:span class=\"inline_block\">        REVOKE      </xhtml:span>       statement and verify the Boolean values are now false.    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# REVOKE INSERT, UPDATE, DELETE ON TABLE customer FROM appreader;      <br/>      REVOKE      <br/>      <br/>      postgres=# select t.tablename, u.usename,      <br/>             has_table_privilege(u.usename, t.tablename, 'select') as select,      <br/>             has_table_privilege(u.usename, t.tablename, 'insert') as insert,      <br/>             has_table_privilege(u.usename, t.tablename, 'update') as update,      <br/>             has_table_privilege(u.usename, t.tablename, 'delete') as delete      <br/>      from   pg_tables t, pg_user u      <br/>      where  t.tablename = 'customer'       <br/>      and    u.usename in ('appwriter','appreader');      <br/>      <br/>      tablename |  usename  | select | insert | update | delete      <br/>      ----------+-----------+--------+--------+--------+--------      <br/>      customer  | appwriter | t      | t      | t      | t      <br/>      customer  | appreader | t      | f      | f      | f      <br/>      (2 rows)    </xhtml:code>    <xhtml:p>      With the publication of       <xhtml:a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-1058\">        CVE-2018-1058      </xhtml:a>      , it is also recommended that all privileges be revoked from the       <xhtml:span class=\"inline_block\">        public      </xhtml:span>       schema for all users on all databases:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# REVOKE CREATE ON SCHEMA public FROM PUBLIC;      <br/>      REVOKE    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_Row_Level_Security_RLS_is_configured_correctly",
                                        "title": "Ensure Row Level Security (RLS) is configured correctly",
                                        "description": "<xhtml:p>  In addition to the SQL-standard privilege system available through   <xhtml:span class=\"inline_block\">    GRANT  </xhtml:span>  , tables can have row security policies that restrict, on a per-user basis, which individual rows can be returned by normal queries or inserted, updated, or deleted by data modification commands. This feature is also known as Row Level Security (RLS).</xhtml:p><xhtml:p>  By default, tables do not have any policies, so if a user has access privileges to a table according to the SQL privilege system, all rows within it are equally available for querying or updating. Row security policies can be specific to commands, to roles, or to both. A policy can be specified to apply to   <xhtml:span class=\"inline_block\">    ALL  </xhtml:span>   commands, or to any combination of   <xhtml:span class=\"inline_block\">    SELECT  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    INSERT  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    UPDATE  </xhtml:span>  , or   <xhtml:span class=\"inline_block\">    DELETE  </xhtml:span>  . Multiple roles can be assigned to a given policy, and normal role membership and inheritance rules apply.</xhtml:p><xhtml:p>  If you use RLS and apply restrictive policies to certain users, it is important that the   <xhtml:span class=\"inline_block\">    Bypass RLS  </xhtml:span>   privilege not be granted to any unauthorized users. This privilege overrides RLS-enabled tables and associated policies. Generally, only superusers and elevated users should possess this privilege.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Protect Information through  Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:6",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Protect Information With Access Control Lists",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  If RLS policies and privileges are not configured correctly, users could perform actions on tables that they are not authorized to perform, such as inserting, updating, or deleting rows.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/ddl-rowsecurity.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/sql-alterrole.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Again, we are using the example from the PostgreSQL documentation using the example       <xhtml:span class=\"inline_block\">        passwd      </xhtml:span>       table. We will create three database roles to illustrate the workings of RLS:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# CREATE ROLE admin;      <br/>      CREATE ROLE      <br/>      postgres=# CREATE ROLE bob;      <br/>      CREATE ROLE      <br/>      postgres=# CREATE ROLE alice;      <br/>      CREATE ROLE    </xhtml:code>    <xhtml:p>      Now, we will insert known data into the       <xhtml:span class=\"inline_block\">        passwd      </xhtml:span>       table:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# INSERT INTO passwd VALUES      <br/>        ('admin','xxx',0,0,'Admin','111-222-3333',null,'/root','/bin/dash');      <br/>      INSERT 0 1      <br/>      postgres=# INSERT INTO passwd VALUES      <br/>        ('bob','xxx',1,1,'Bob','123-456-7890',null,'/home/bob','/bin/zsh');      <br/>      INSERT 0 1      <br/>      postgres=# INSERT INTO passwd VALUES      <br/>        ('alice','xxx',2,1,'Alice','098-765-4321',null,'/home/alice','/bin/zsh');      <br/>      INSERT 0 1    </xhtml:code>    <xhtml:p>      And we will enable RLS on the table:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# ALTER TABLE passwd ENABLE ROW LEVEL SECURITY;      <br/>      ALTER TABLE    </xhtml:code>    <xhtml:p>      Now that RLS is enabled, we need to define one or more policies. Create the administrator policy and allow it access to all rows:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# CREATE POLICY admin_all ON passwd TO admin USING (true) WITH CHECK (true);      <br/>      CREATE POLICY    </xhtml:code>    <xhtml:p>      Create a policy for normal users to       <xhtml:em>        view      </xhtml:em>       all rows:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# CREATE POLICY all_view ON passwd FOR SELECT USING (true);      <br/>      CREATE POLICY    </xhtml:code>    <xhtml:p>      Create a policy for normal users that allows them to update only their own rows and to limit what values can be set for their login shell:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# CREATE POLICY user_mod ON passwd FOR UPDATE      <br/>        USING (current_user = user_name)      <br/>        WITH CHECK (      <br/>          current_user = user_name AND      <br/>          shell IN ('/bin/bash','/bin/sh','/bin/dash','/bin/zsh','/bin/tcsh')      <br/>        );      <br/>      CREATE POLICY    </xhtml:code>    <xhtml:p>      Grant all the normal rights on the table to the       <xhtml:span class=\"inline_block\">        admin      </xhtml:span>       user:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# GRANT SELECT, INSERT, UPDATE, DELETE ON passwd TO admin;      <br/>      GRANT    </xhtml:code>    <xhtml:p>      Grant only select access on non-sensitive columns to everyone:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# GRANT SELECT      <br/>        (user_name, uid, gid, real_name, home_phone, extra_info, home_dir, shell)      <br/>        ON passwd TO public;      <br/>      GRANT    </xhtml:code>    <xhtml:p>      Grant update to only the sensitive columns:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# GRANT UPDATE      <br/>        (pwhash, real_name, home_phone, extra_info, shell)      <br/>        ON passwd TO public;      <br/>      GRANT    </xhtml:code>    <xhtml:p>      Ensure that no one has been granted       <xhtml:span class=\"inline_block\">        Bypass RLS      </xhtml:span>       inadvertently, by running the       <xhtml:span class=\"inline_block\">        psql      </xhtml:span>       display command       <xhtml:span class=\"inline_block\">        \\du+      </xhtml:span>      . If unauthorized users do have       <xhtml:span class=\"inline_block\">        Bypass RLS      </xhtml:span>       granted then resolve this using the       <xhtml:span class=\"inline_block\">        ALTER ROLE       </xhtml:span>      <xhtml:em>        <xhtml:span class=\"inline_block\">          &lt;user&gt;        </xhtml:span>      </xhtml:em>      <xhtml:span class=\"inline_block\">         NOBYPASSRLS;      </xhtml:span>       command.    </xhtml:p>    <xhtml:p>      You can now verify that 'admin', 'bob', and 'alice' are properly restricted by querying the       <xhtml:span class=\"inline_block\">        passwd      </xhtml:span>       table as each of these roles.    </xhtml:p>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_the_set_user_extension_is_installed",
                                        "title": "Ensure the set_user extension is installed",
                                        "description": "<xhtml:p>  PostgreSQL access to the superuser database role must be controlled and audited to prevent unauthorized access.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Ensure the Use of Dedicated Administrative Accounts",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4:3",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Users",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Administrators Should Not Directly Log In To A System (i.e. use RunAs/sudo)",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:8",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Even when reducing and limiting the access to the superuser role as described earlier in this benchmark, it is still difficult to determine who accessed the superuser role and what actions were taken using that role. As such, it is ideal to prevent anyone from logging in as the superuser and forcing them to escalate their role. This model is used at the OS level by the use of   <xhtml:span class=\"inline_block\">    sudo  </xhtml:span>   and should be emulated in the database. The   <xhtml:span class=\"inline_block\">    set_user  </xhtml:span>   extension allows for this setup.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/8"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://github.com/pgaudit/set_user/tree/REL1_0_STABLE"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      At the time this benchmark is being written,       <xhtml:span class=\"inline_block\">        set_user      </xhtml:span>       is not available as a package in the PGDG repository. As such, we will build it from source:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ yum -y install postgresql96-devel      <br/>      Loaded plugins: fastestmirror      <br/>      Setting up Install Process      <br/>      Loading mirror speeds from cached hostfile      <br/>       * base: mirror.cisp.com      <br/>       * extras: packages.oit.ncsu.edu      <br/>       * updates: mirror.cisp.com      <br/>      Resolving Dependencies      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package postgresql96-devel.x86_64 0:9.6.10-1PGDG.rhel6 will be installed      <br/>      --&gt; Finished Dependency Resolution      <br/>      <br/>      Dependencies Resolved      <br/>      <br/>      ===========================================================================================================      <br/>       Package                        Arch               Version                        Repository          Size      <br/>      ===========================================================================================================      <br/>      Installing:      <br/>       postgresql96-devel             x86_64             9.6.10-1PGDG.rhel6             pgdg96             1.7 M      <br/>      <br/>      Transaction Summary      <br/>      ===========================================================================================================      <br/>      Install       1 Package(s)      <br/>      <br/>      Total download size: 1.7 M      <br/>      Installed size: 7.9 M      <br/>      Downloading Packages:      <br/>      postgresql96-devel-9.6.10-1PGDG.rhel6.x86_64.rpm                                    | 1.7 MB     00:01      <br/>      Running rpm_check_debug      <br/>      Running Transaction Test      <br/>      Transaction Test Succeeded      <br/>      Running Transaction      <br/>      Warning: RPMDB altered outside of yum.      <br/>        Installing : postgresql96-devel-9.6.10-1PGDG.rhel6.x86_64                                            1/1      <br/>        Verifying  : postgresql96-devel-9.6.10-1PGDG.rhel6.x86_64                                            1/1      <br/>      <br/>      Installed:      <br/>        postgresql96-devel.x86_64 0:9.6.10-1PGDG.rhel6      <br/>      <br/>      Complete!      <br/>      $      <br/>      $ curl https://codeload.github.com/pgaudit/set_user/tar.gz/REL1_6_1 &gt; set_user-1.6.1.tgz      <br/>        % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current      <br/>                                       Dload  Upload   Total   Spent    Left  Speed      <br/>      100 14916    0 14916    0     0  57215      0 --:--:-- --:--:-- --:--:--  184k      <br/>      $      <br/>      $ tar xf set_user-1.6.1tgz      <br/>      $ cd set_user-REL1_6_1      <br/>      $ export PATH=/usr/pgsql-9.6/bin:$PATH      <br/>      [root@centos6 set_user-REL1_6_1]# make USE_PGXS=1      <br/>      gcc -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wendif-labels -Wmissing-format-attribute -Wformat-security -fno-strict-aliasing -fwrapv -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -fPIC -I. -I./ -I/usr/pgsql-9.6/include/server -I/usr/pgsql-9.6/include/internal -D_GNU_SOURCE -I/usr/include/libxml2  -I/usr/include  -c -o set_user.o set_user.c      <br/>      gcc -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wendif-labels -Wmissing-format-attribute -Wformat-security -fno-strict-aliasing -fwrapv -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -fPIC -L/usr/pgsql-9.6/lib -Wl,--as-needed  -L/usr/lib64 -Wl,--as-needed -Wl,-rpath,'/usr/pgsql-9.6/lib',--enable-new-dtags -lm  -shared -o set_user.so set_user.o      <br/>      [root@centos6 set_user-REL1_6_1]# make USE_PGXS=1 install      <br/>      /bin/mkdir -p '/usr/pgsql-9.6/share/extension'      <br/>      /bin/mkdir -p '/usr/pgsql-9.6/share/extension'      <br/>      /bin/mkdir -p '/usr/pgsql-9.6/lib'      <br/>      /usr/bin/install -c -m 644 \"set_user.h\" /usr/pgsql-9.6/include      <br/>      /usr/bin/install -c -m 644 .//set_user.control '/usr/pgsql-9.6/share/extension/'      <br/>      /usr/bin/install -c -m 644 .//set_user--1.6.sql .//set_user--1.5--1.6.sql .//set_user--1.4--1.5.sql .//set_user--1.1--1.4.sql .//set_user--1.0--1.1.sql  '/usr/pgsql-9.6/share/extension/'      <br/>      /usr/bin/install -c -m 755  set_user.so '/usr/pgsql-9.6/lib/'    </xhtml:code>    <xhtml:p>      Now that       <xhtml:span class=\"inline_block\">        set_user      </xhtml:span>       is installed, we need to tell PostgreSQL to load its library:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ vi ~postgres/9.6/data/postgresql.conf      <br/>      # load set_user libs before anything else      <br/>      shared_preload_libraries = 'set_user, other_libs'      <br/>      $ service postgresql-9.6 restart      <br/>      Stopping postgresql-9.6 service:                           [  OK  ]      <br/>      Starting postgresql-9.6 service:                           [  OK  ]    </xhtml:code>    <xhtml:p>      And now, we can install the extension from with SQL:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# select * from pg_available_extensions where name = 'set_user';      <br/>         name   | default_version | installed_version |                  comment      <br/>      ----------+-----------------+-------------------+--------------------------------------------      <br/>       set_user | 1.6             |                   | similar to SET ROLE but with added logging      <br/>      (1 row)      <br/>      <br/>      postgres=# create extension set_user;      <br/>      CREATE EXTENSION      <br/>      postgres=# select * from pg_available_extensions where name = 'set_user';      <br/>         name   | default_version | installed_version |                  comment      <br/>      ----------+-----------------+-------------------+--------------------------------------------      <br/>       set_user | 1.6             | 1.6               | similar to SET ROLE but with added logging      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      Now, we use       <xhtml:span class=\"inline_block\">        GRANT      </xhtml:span>       to configure each DBA role to allow it to use the       <xhtml:span class=\"inline_block\">        set_user      </xhtml:span>       functions. In the example below, we will configure my db user       <xhtml:span class=\"inline_block\">        doug      </xhtml:span>      . (You would do this for each DBA's normal user role.)    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# grant execute on function set_user(text) to doug;      <br/>      GRANT      <br/>      postgres=# grant execute on function set_user_u(text) to doug;      <br/>      GRANT    </xhtml:code>    <xhtml:p>      Connect to PostgreSQL as yourself and verify it works as expected:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      psql      <br/>      $ psql -U doug -d postgres      <br/>      postgres=&gt; select set_user('postgres');      <br/>      ERROR:  switching to superuser not allowed      <br/>      HINT:  Use 'set_user_u' to escalate.      <br/>      postgres=&gt; select set_user_u('postgres');      <br/>       set_user_u      <br/>      ------------      <br/>       OK      <br/>      (1 row)      <br/>      <br/>      postgres=# select current_user, session_user;      <br/>       current_user | session_user      <br/>      --------------+--------------      <br/>       postgres     | doug      <br/>      (1 row)      <br/>      <br/>      postgres=# select reset_user();      <br/>       reset_user      <br/>      ------------      <br/>       OK      <br/>      (1 row)      <br/>      <br/>      postgres=&gt; select current_user, session_user;      <br/>       current_user | session_user      <br/>      --------------+--------------      <br/>       doug         | doug      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      Once all DBA's normal user accounts have been       <xhtml:span class=\"inline_block\">        GRANT      </xhtml:span>      ed permission, revoke the ability to login as the       <xhtml:span class=\"inline_block\">        postgres      </xhtml:span>       (superuser) user:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# alter user postgres NOLOGIN;      <br/>      ALTER ROLE    </xhtml:code>    <xhtml:p>      Which results in:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ psql      <br/>      psql: FATAL:  role \"postgres\" is not permitted to log in      <br/>      $ psql -U doug -d postgres      <br/>      psql (9.6.10)    </xhtml:code>    <xhtml:p>      Make sure there are no other roles that are superuser's and can still login:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# SELECT rolname FROM pg_authid WHERE rolsuper and rolcanlogin;      <br/>       rolname      <br/>      ---------      <br/>      (0 rows)    </xhtml:code>    <xhtml:p>      Verify there are no unprivileged roles that can login directly that are granted a superuser role even if it is multiple layers removed:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# DROP VIEW IF EXISTS roletree;      <br/>      NOTICE:  view \"roletree\" does not exist, skipping      <br/>      DROP VIEW      <br/>      postgres=# CREATE OR REPLACE VIEW roletree AS      <br/>      postgres-# WITH RECURSIVE      <br/>      postgres-# roltree AS (      <br/>      postgres(#   SELECT u.rolname AS rolname,      <br/>      postgres(#          u.oid AS roloid,      <br/>      postgres(#          u.rolcanlogin,      <br/>      postgres(#          u.rolsuper,      <br/>      postgres(#          '{}'::name[] AS rolparents,      <br/>      postgres(#          NULL::oid AS parent_roloid,      <br/>      postgres(#          NULL::name AS parent_rolname      <br/>      postgres(#   FROM pg_catalog.pg_authid u      <br/>      postgres(#   LEFT JOIN pg_catalog.pg_auth_members m on u.oid = m.member      <br/>      postgres(#   LEFT JOIN pg_catalog.pg_authid g on m.roleid = g.oid      <br/>      postgres(#   WHERE g.oid IS NULL      <br/>      postgres(#   UNION ALL      <br/>      postgres(#   SELECT u.rolname AS rolname,      <br/>      postgres(#          u.oid AS roloid,      <br/>      postgres(#          u.rolcanlogin,      <br/>      postgres(#          u.rolsuper,      <br/>      postgres(#          t.rolparents || g.rolname AS rolparents,      <br/>      postgres(#          g.oid AS parent_roloid,      <br/>      postgres(#          g.rolname AS parent_rolname      <br/>      postgres(#   FROM pg_catalog.pg_authid u      <br/>      postgres(#   JOIN pg_catalog.pg_auth_members m on u.oid = m.member      <br/>      postgres(#   JOIN pg_catalog.pg_authid g on m.roleid = g.oid      <br/>      postgres(#   JOIN roltree t on t.roloid = g.oid      <br/>      postgres(# )      <br/>      postgres-# SELECT      <br/>      postgres-#   r.rolname,      <br/>      postgres-#   r.roloid,      <br/>      postgres-#   r.rolcanlogin,      <br/>      postgres-#   r.rolsuper,      <br/>      postgres-#   r.rolparents      <br/>      postgres-# FROM roltree r      <br/>      postgres-# ORDER BY 1;      <br/>      CREATE VIEW      <br/>      postgres=# SELECT      <br/>      postgres-#   ro.rolname,      <br/>      postgres-#   ro.roloid,      <br/>      postgres-#   ro.rolcanlogin,      <br/>      postgres-#   ro.rolsuper,      <br/>      postgres-#   ro.rolparents      <br/>      postgres-# FROM roletree ro      <br/>      postgres-# WHERE (ro.rolcanlogin AND ro.rolsuper)      <br/>      postgres-# OR      <br/>      postgres-# (      <br/>      postgres(#     ro.rolcanlogin AND EXISTS      <br/>      postgres(#     (      <br/>      postgres(#       SELECT TRUE FROM roletree ri      <br/>      postgres(#       WHERE ri.rolname = ANY (ro.rolparents)      <br/>      postgres(#       AND ri.rolsuper      <br/>      postgres(#     )      <br/>      postgres(# );      <br/>       rolname | roloid | rolcanlogin | rolsuper | rolparents      <br/>      ---------+--------+-------------+----------+------------      <br/>      (0 rows)    </xhtml:code>    <xhtml:p>      If any roles are identified by this query, use       <xhtml:span class=\"inline_block\">        REVOKE      </xhtml:span>       to correct.    </xhtml:p>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        Much like the venerable         <xhtml:span class=\"inline_block\">          sudo        </xhtml:span>         does for the OS,         <xhtml:span class=\"inline_block\">          set_user        </xhtml:span>         manages superuser access for PostgreSQL. Complete configuration of         <xhtml:span class=\"inline_block\">          set_user        </xhtml:span>         is documented at the extension's         <xhtml:a href=\"https://github.com/pgaudit/set_user\">          website        </xhtml:a>         and should be reviewed to ensure the logging entries that your organization cares about are properly configured.      </xhtml:p>      <xhtml:p>        Note that some external tools assume they can connect as the         <xhtml:span class=\"inline_block\">          postgres        </xhtml:span>         user by default and this is no longer true. You may find some tools need different options, reconfigured, or even abandoned to compensate for this.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_5_Connection_and_Login",
                    "title": "Connection and Login",
                    "description": "<xhtml:p>  The restrictions on client/user connections to the PostgreSQL database blocks unauthorized access to data and services by setting access rules. These security measures help to ensure that successful logins cannot be easily made through brute-force password attacks, pass the hash, or intuited by clever social engineering exploits.</xhtml:p><xhtml:p>  Settings are generally recommended to be applied to all defined profiles. The following presents standalone examples of logins for particular use cases. The authentication rules are read from the PostgreSQL host-based authentication file,   <xhtml:span class=\"inline_block\">    pg_hba.conf  </xhtml:span>  , from top to bottom. The first rule conforming to the condition of the request executes the METHOD   <xhtml:em>    and stops further processing of the file  </xhtml:em>  . Incorrectly applied rules, as defined by a single line instruction, can substantially alter the intended behavior resulting in either allowing or denying login attempts.</xhtml:p><xhtml:p>  It is strongly recommended that authentication configurations be constructed incrementally with rigid testing for each newly applied rule. Because of the large number of different variations, this benchmark limits itself to a small number of authentication methods that can be successfully applied under most circumstances. Further analysis, using the other authentication methods available in PostgreSQL, is encouraged.</xhtml:p>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_login_via_local_UNIX_Domain_Socket_is_configured_correctly",
                                        "title": "Ensure login via \"local\" UNIX Domain Socket is configured correctly",
                                        "description": "<xhtml:p>  A remote host login, via ssh, is arguably the most secure means of remotely accessing and administering the PostgreSQL server. Connecting with the   <xhtml:span class=\"inline_block\">    psql  </xhtml:span>   client, via UNIX DOMAIN SOCKETS, using the   <xhtml:span class=\"inline_block\">    peer  </xhtml:span>   authentication method is the most secure mechanism available for local connections. Provided a database user account of the same name of the UNIX account has already been defined in the database, even ordinary user accounts can access the cluster in a similarly highly secure manner.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Use Multifactor Authentication For All Administrative Access",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4:5",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Users",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Use Only Secure Channels For Remote System Administration",
                                                        "urn": "urn:cisecurity.org:controls:6.0:3:4",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/3/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/5"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/client-authentication.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/auth-pg-hba-conf.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Creation of a database account that matches the local account allows PEER authentication:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ psql -c \"CREATE ROLE user1 WITH LOGIN;\"      <br/>      CREATE ROLE    </xhtml:code>    <xhtml:p>      Execute the following as the UNIX user account, the default authentication rules should now permit the login:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ su - user1      <br/>      $ whoami      <br/>      user1      <br/>      $ psql -d postgres      <br/>      psql (9.6.10)      <br/>      Type \"help\" for help.      <br/>      <br/>      postgres=&gt;    </xhtml:code>    <xhtml:p>      As per the host-based authentication rules in       <xhtml:span class=\"inline_block\">        $PGDATA/pg_hba.conf      </xhtml:span>      , all login attempts via UNIX DOMAIN SOCKETS are processed on the line beginning with       <xhtml:span class=\"inline_block\">        local      </xhtml:span>      .    </xhtml:p>    <xhtml:p>      This is the minimal rule that must be in place allowing PEER connections:    </xhtml:p>    <xhtml:code class=\"code_block\">      # TYPE  DATABASE        USER            ADDRESS                 METHOD      <br/>      local   all             postgres                                peer    </xhtml:code>    <xhtml:p>      More traditionally, a rule like the following would be used to allow any local PEER connection:    </xhtml:p>    <xhtml:code class=\"code_block\">      # TYPE  DATABASE        USER            ADDRESS                 METHOD      <br/>      local   all             all                                     peer    </xhtml:code>    <xhtml:p>      Once edited, the server process must reload the authentication file before it can take effect. Improperly configured rules cannot update i.e. the old rules remain in place. The PostgreSQL logs will report the outcome of the SIGHUP:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# select pg_reload_conf();      <br/>       pg_reload_conf      <br/>      ----------------      <br/>       t      <br/>      (1 row)    </xhtml:code>    <xhtml:p>      The following examples illustrate other possible configurations. The resultant \"rule\" of success/failure depends upon the first matching line:    </xhtml:p>    <xhtml:code class=\"code_block\">      # allow postgres user logins# TYPE  DATABASE        USER            ADDRESS                 METHOD      <br/>      local   all             postgres                                peer    </xhtml:code>    <xhtml:code class=\"code_block\">      # allow all local users# TYPE  DATABASE        USER            ADDRESS                 METHOD      <br/>      local   all             all                                     peer    </xhtml:code>    <xhtml:code class=\"code_block\">      # allow all local users only if they are connecting to a db named the same as their username      <br/>      # e.g. if user 'bob' is connecting to a db named 'bob'      <br/>      # TYPE  DATABASE        USER                                    METHOD      <br/>      local   samerole        all                                     peer    </xhtml:code>    <xhtml:code class=\"code_block\">      # allow only local users who are members of the 'rw' role in the db      <br/>      # TYPE  DATABASE        USER            ADDRESS                 METHOD      <br/>      local   all             +rw                                     peer    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_login_via_host_TCPIP_Socket_is_configured_correctly",
                                        "title": "Ensure login via \"host\" TCP/IP Socket is configured correctly",
                                        "description": "<xhtml:p>  A large number of authentication METHODs are available for hosts connecting using TCP/IP sockets, including:</xhtml:p><xhtml:ul>  <xhtml:li>    <xhtml:span class=\"inline_block\">      trust    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      reject    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      md5    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      password    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      gss    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      sspi    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      ident    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      pam    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      ldap    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      radius    </xhtml:span>  </xhtml:li>  <xhtml:li>    <xhtml:span class=\"inline_block\">      cert    </xhtml:span>  </xhtml:li></xhtml:ul><xhtml:p>  METHODs   <xhtml:span class=\"inline_block\">    trust  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    password  </xhtml:span>  , and   <xhtml:span class=\"inline_block\">    ident  </xhtml:span>   are   <xhtml:strong>    not  </xhtml:strong>   to be used for remote logins. METHOD   <xhtml:span class=\"inline_block\">    md5  </xhtml:span>   is the most popular and can be used in both encrypted and unencrypted sessions.</xhtml:p><xhtml:p>  Use of the   <xhtml:span class=\"inline_block\">    gss  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    sspi  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    pam  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    ldap  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    radius  </xhtml:span>  , and   <xhtml:span class=\"inline_block\">    cert  </xhtml:span>   METHODs, while more secure than   <xhtml:span class=\"inline_block\">    md5  </xhtml:span>  , are dependent upon the availability of external authenticating processes/services and thus are not covered in this benchmark.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt All Sensitive Information in Transit",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt All Sensitive Information Over Less-trusted Networks",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/client-authentication.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/auth-pg-hba-conf.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Confirm a login attempt has been made by looking for a logged error message detailing the nature of the authenticating failure. In the case of failed login attempts, whether encrypted or unencrypted, check the following:    </xhtml:p>    <xhtml:ul>      <xhtml:li>        The server should be sitting on a port exposed to the remote connecting host i.e. NOT ip address 127.0.0.1        <xhtml:code class=\"code_block\">          listen_addresses = '*'          <br/>             ```          <br/>          * An authenticating rule must exist in the file `pg_hba.conf`          <br/>          <br/>          This example permits only encrypted sessions for the `postgres` role and denies all unencrypted session for the `postgres` role:        </xhtml:code>      </xhtml:li>    </xhtml:ul>    <xhtml:code class=\"code_block\">       # TYPE    DATABASE           USER            ADDRESS                 METHOD hostssl    all             postgres         0.0.0.0/0                 md5 hostnossl  all             postgres         0.0.0.0/0                 reject    </xhtml:code>    <xhtml:p>      The following examples illustrate other possible configurations. The resultant \"rule\" of success/failure depends upon the       <xhtml:strong>        first matching line      </xhtml:strong>      .    </xhtml:p>    <xhtml:code class=\"code_block\">      # allow 'postgres' user only from 'localhost/loopback' connections# and only if you know the password# TYPE    DATABASE        USER            ADDRESS                 METHODhost      all             postgres        127.0.0.1/32            md5# allow users to connect remotely only to the database named after them, # with the correct user password:# (accepts both SSL and non-SSL connections)# TYPE    DATABASE        USER            ADDRESS                 METHODhost      samerole        all             0.0.0.0/0               md5# allow only those users who are a member of the 'rw' role to connect# only to the database named after them, with the correct user password:# (accepts both SSL and non-SSL connections)# TYPE    DATABASE        USER            ADDRESS                 METHODhost      samerole        +rw             0.0.0.0/0               md5    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_6_PostgreSQL_Settings",
                    "title": "PostgreSQL Settings",
                    "description": "<xhtml:p>  As PostgreSQL evolves with each new iteration, configuration parameters are constantly being added, deprecated, or removed. These configuration parameters define not only server function but how well it performs.</xhtml:p><xhtml:p>  Many routine activities, combined with a specific set of configuration parameter values, can sometimes result in degraded performance and, under a specific set of conditions, even comprise the security of the RDBMS. The fact of the matter is that any parameter has the potential to affect the accessibility and performance of a running server.</xhtml:p><xhtml:p>  Rather than describing all the possible combination of events, this benchmark describes how a parameter can be compromised. Examples reflect the most common, and easiest to understand, exploits. Although by no means exhaustive, it is hoped that you will be able to understand the attack vectors in the context of your environment.</xhtml:p>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_Attack_Vectors_Runtime_Parameters_are_Configured",
                                        "title": "Ensure 'Attack Vectors' Runtime Parameters are Configured",
                                        "description": "<xhtml:p>  Understanding the vulnerability of PostgreSQL runtime parameters by the particular delivery method, or attack vector.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Use Standard Hardening Configuration Templates for Databases",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18:11",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Use Standard Database Hardening Templates",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18:7",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  There are as many ways of compromising a server as there are runtime parameters. A combination of any one or more of them executed at the right time under the right conditions has the potential to compromise the RDBMS. Mitigating risk is dependent upon one's understanding of the attack vectors and includes:</xhtml:p><xhtml:ol>  <xhtml:li>    Via user session: includes those runtime parameters that can be set by a ROLE that persists for the life of a server-client session.  </xhtml:li>  <xhtml:li>    Via attribute: includes those runtime parameters that can be set by a ROLE during a server-client session that can be assigned as an attribute for an entity such as a table, index, database, or role.  </xhtml:li>  <xhtml:li>    Via server reload: includes those runtime parameters that can be set by the superuser using a SIGHUP or configuration file reload command and affects the entire cluster.  </xhtml:li>  <xhtml:li>    Via server restart: includes those runtime parameters that can be set and effected by restarting the server process and affects the entire cluster.  </xhtml:li></xhtml:ol>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/7"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      In the case of a changed parameter, the value is returned back to its default value. In the case of a successful exploit of an already set runtime parameter then an analysis must be carried out determining the best approach mitigating the risk.    </xhtml:p>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        It can be difficult to totally eliminate risk. Once changed, detecting a miscreant parameter can become problematic.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_backend_runtime_parameters_are_configured_correctly",
                                        "title": "Ensure 'backend' runtime parameters are configured correctly",
                                        "description": "<xhtml:p>  In order to serve multiple clients efficiently, the PostgreSQL server launches a new \"backend\" process for each client. The runtime parameters in this benchmark section are controlled by the backend process. The server's performance, in the form of slow queries causing a denial of service, and the RDBM's auditing abilities for determining root cause analysis can be compromised via these parameters.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Use Standard Hardening Configuration Templates for Databases",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18:11",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Use Standard Database Hardening Templates",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18:7",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  A denial of service is possible by denying the use of indexes and by slowing down client access to an unreasonable level. Unsanctioned behavior can be introduced by introducing rogue libraries which can then be called in a database session. Logging can be altered and obfuscated inhibiting root cause analysis.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/7"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/view-pg-settings.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Once detected, the unauthorized/undesired change can be corrected by altering the configuration file and executing a server restart. In the case where the parameter has been on the command line invocation of       <xhtml:span class=\"inline_block\">        pg_ctl      </xhtml:span>       the       <xhtml:span class=\"inline_block\">        restart      </xhtml:span>       invocation is insufficient and an explicit       <xhtml:span class=\"inline_block\">        stop      </xhtml:span>       and       <xhtml:span class=\"inline_block\">        start      </xhtml:span>       must instead be made.    </xhtml:p>    <xhtml:ol>      <xhtml:li>        Query the view         <xhtml:span class=\"inline_block\">          pg_settings        </xhtml:span>         and compare with previous query outputs for any changes.      </xhtml:li>      <xhtml:li>        Review configuration files         <xhtml:span class=\"inline_block\">          postgresql.conf        </xhtml:span>         and         <xhtml:span class=\"inline_block\">          postgresql.auto.conf        </xhtml:span>         and compare them with previously archived file copies for any changes.      </xhtml:li>      <xhtml:li>        Examine the process output and look for parameters that were used at server startup:        <xhtml:code class=\"code_block\">          ps aux | grep -E '[p]ostgres|[p]ostmaster'        </xhtml:code>      </xhtml:li>    </xhtml:ol>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        All changes made on this level will affect the overall behavior of the server. These changes can only be affected by a server restart after the parameters have been altered in the configuration files.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74347",
                                                        "artifact_title": "Check ignore_system_indexes",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "select setting from pg_settings where name = 'ignore_system_indexes' AND context IN ('backend','superuser-backend') order by 1;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": "off"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": "setting"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                },
                                                {
                                                    "and": [
                                                        {
                                                            "artifact-expression": {
                                                                "artifact-unique-id": "74348",
                                                                "artifact_title": "Check log_connections",
                                                                "artifact": {
                                                                    "type": "independent.sql57_v1",
                                                                    "parameters": [
                                                                        {
                                                                            "parameter": {
                                                                                "name": "engine",
                                                                                "dt": "string",
                                                                                "value": "postgre"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "sql",
                                                                                "dt": "string",
                                                                                "value": "select setting from pg_settings where name = 'log_connections' AND context IN ('backend','superuser-backend') order by 1;"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "version",
                                                                                "dt": "string",
                                                                                "value": "9.6"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "prepend_str",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "append_str",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "prepend_type",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "append_type",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        }
                                                                    ]
                                                                },
                                                                "test": {
                                                                    "type": "independent.sql57_v1",
                                                                    "parameters": [
                                                                        {
                                                                            "parameter": {
                                                                                "name": "check_existence",
                                                                                "dt": "string",
                                                                                "value": "at_least_one_exists"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "check",
                                                                                "dt": "string",
                                                                                "value": "all"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "value",
                                                                                "dt": "string",
                                                                                "value": "on"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "value_data_type",
                                                                                "dt": "string",
                                                                                "value": "string"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "field_name",
                                                                                "dt": "string",
                                                                                "value": "setting"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "field_operation",
                                                                                "dt": "string",
                                                                                "value": "equals"
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "and": [
                                                                {
                                                                    "artifact-expression": {
                                                                        "artifact-unique-id": "74349",
                                                                        "artifact_title": "Check log disconnections",
                                                                        "artifact": {
                                                                            "type": "independent.sql57_v1",
                                                                            "parameters": [
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "engine",
                                                                                        "dt": "string",
                                                                                        "value": "postgre"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "sql",
                                                                                        "dt": "string",
                                                                                        "value": "select setting from pg_settings where name = 'log_disconnections' AND context IN ('backend','superuser-backend') order by 1;"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "version",
                                                                                        "dt": "string",
                                                                                        "value": "9.6"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "prepend_str",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "append_str",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "prepend_type",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "append_type",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                }
                                                                            ]
                                                                        },
                                                                        "test": {
                                                                            "type": "independent.sql57_v1",
                                                                            "parameters": [
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "check_existence",
                                                                                        "dt": "string",
                                                                                        "value": "at_least_one_exists"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "check",
                                                                                        "dt": "string",
                                                                                        "value": "all"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "value",
                                                                                        "dt": "string",
                                                                                        "value": "on"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "value_data_type",
                                                                                        "dt": "string",
                                                                                        "value": "string"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "field_name",
                                                                                        "dt": "string",
                                                                                        "value": "setting"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "field_operation",
                                                                                        "dt": "string",
                                                                                        "value": "equals"
                                                                                    }
                                                                                }
                                                                            ]
                                                                        }
                                                                    }
                                                                },
                                                                {
                                                                    "artifact-expression": {
                                                                        "artifact-unique-id": "74350",
                                                                        "artifact_title": "Check post_auth_delay",
                                                                        "artifact": {
                                                                            "type": "independent.sql57_v1",
                                                                            "parameters": [
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "engine",
                                                                                        "dt": "string",
                                                                                        "value": "postgre"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "sql",
                                                                                        "dt": "string",
                                                                                        "value": "select setting from pg_settings where name = 'post_auth_delay' AND context IN ('backend','superuser-backend') order by 1;"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "version",
                                                                                        "dt": "string",
                                                                                        "value": "9.6"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "prepend_str",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "append_str",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "prepend_type",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "append_type",
                                                                                        "dt": "string",
                                                                                        "value": ""
                                                                                    }
                                                                                }
                                                                            ]
                                                                        },
                                                                        "test": {
                                                                            "type": "independent.sql57_v1",
                                                                            "parameters": [
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "check_existence",
                                                                                        "dt": "string",
                                                                                        "value": "at_least_one_exists"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "check",
                                                                                        "dt": "string",
                                                                                        "value": "all"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "value",
                                                                                        "dt": "string",
                                                                                        "value": "0"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "value_data_type",
                                                                                        "dt": "string",
                                                                                        "value": "int"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "field_name",
                                                                                        "dt": "string",
                                                                                        "value": "setting"
                                                                                    }
                                                                                },
                                                                                {
                                                                                    "parameter": {
                                                                                        "name": "field_operation",
                                                                                        "dt": "string",
                                                                                        "value": "equals"
                                                                                    }
                                                                                }
                                                                            ]
                                                                        }
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_Postmaster_Runtime_Parameters_are_Configured",
                                        "title": "Ensure 'Postmaster' Runtime Parameters are Configured",
                                        "description": "<xhtml:p>  PostgreSQL runtime parameters that are executed by the postmaster process.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": {
                                                    "implementationGroup": null,
                                                    "title": null,
                                                    "urn": null,
                                                    "securityFunction": null,
                                                    "assetType": null
                                                },
                                                "control": [
                                                    {
                                                        "title": "Application Software Security",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18"
                                                    },
                                                    {
                                                        "title": "Application Software Security",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  The   <xhtml:span class=\"inline_block\">    postmaster  </xhtml:span>  , or   <xhtml:span class=\"inline_block\">    postgres  </xhtml:span>  , process is the supervisory process that assigns a backend process to an incoming client connection. The   <xhtml:span class=\"inline_block\">    postmaster  </xhtml:span>   manages key runtime parameters that are either shared by all backend connections or needed by the   <xhtml:span class=\"inline_block\">    postmaster  </xhtml:span>   process itself to run.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/view-pg-settings.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Once detected, the unauthorized/undesired change can be corrected by editing the altered configuration file and executing a server restart. In the case where the parameter has been on the command line invocation of       <xhtml:span class=\"inline_block\">        pg_ctl      </xhtml:span>       the       <xhtml:span class=\"inline_block\">        restart      </xhtml:span>       invocation is insufficient and an explicit       <xhtml:span class=\"inline_block\">        stop      </xhtml:span>       and       <xhtml:span class=\"inline_block\">        start      </xhtml:span>       must instead be made.    </xhtml:p>    <xhtml:p>      Detecting a change is possible by one of the following methods:    </xhtml:p>    <xhtml:ol>      <xhtml:li>        Query the view         <xhtml:span class=\"inline_block\">          pg_settings        </xhtml:span>         and compare with previous query outputs for any changes      </xhtml:li>      <xhtml:li>        Review the configuration files         <xhtml:span class=\"inline_block\">          postgresql.conf        </xhtml:span>         and         <xhtml:span class=\"inline_block\">          postgresql.auto.conf        </xhtml:span>         and compare with previously archived file copies for any changes      </xhtml:li>      <xhtml:li>        Examine the process output and look for parameters that were used at server startup:        <xhtml:code class=\"code_block\">          ps aux | grep -E '[p]ostgres|[p]ostmaster'        </xhtml:code>      </xhtml:li>    </xhtml:ol>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        All changes made on this level will affect the overall behavior of the server. These changes can be effected by editing the PostgreSQL configuration files and by either executing a server SIGHUP from the command line or, as superuser         <xhtml:span class=\"inline_block\">          postgres        </xhtml:span>        , executing the SQL command         <xhtml:span class=\"inline_block\">          select pg_reload_conf()        </xhtml:span>        . A denial of service is possible by the over-allocating of limited resources, such as RAM. Data can be corrupted by allowing damaged pages to load or by changing parameters to reinterpret values in an unexpected fashion, e.g. changing the time zone. Client messages can be altered in such a way as to interfere with the application logic. Logging can be altered and obfuscated inhibiting root cause analysis.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74351",
                                                        "artifact_title": "Ensure 'Postmaster' Runtime Parameters are Configured",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "select name, setting from pg_settings where context = 'postmaster' order by 1;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_SIGHUP_Runtime_Parameters_are_Configured",
                                        "title": "Ensure 'SIGHUP' Runtime Parameters are Configured",
                                        "description": "<xhtml:p>  PostgreSQL runtime parameters that are executed by the SIGHUP signal.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": {
                                                    "implementationGroup": null,
                                                    "title": null,
                                                    "urn": null,
                                                    "securityFunction": null,
                                                    "assetType": null
                                                },
                                                "control": [
                                                    {
                                                        "title": "Application Software Security",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18"
                                                    },
                                                    {
                                                        "title": "Application Software Security",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  In order to define server behavior and optimize server performance, the server's superuser has the privilege of setting these parameters which are found in the configuration files   <xhtml:span class=\"inline_block\">    postgresql.conf  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    pg_hba.conf  </xhtml:span>  . Alternatively, those parameters found in   <xhtml:span class=\"inline_block\">    postgresql.conf  </xhtml:span>   can also be changed using a server login session and executing the SQL command   <xhtml:span class=\"inline_block\">    ALTER SYSTEM  </xhtml:span>   which writes its changes in the configuration file   <xhtml:span class=\"inline_block\">    postgresql.auto.conf  </xhtml:span>  .</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/view-pg-settings.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Restore all values in the PostgreSQL configuration files and invoke the server to reload the configuration files.    </xhtml:p>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        All changes made on this level will affect the overall behavior of the server. These changes can be effected by editing the PostgreSQL configuration files and by either executing a server SIGHUP from the command line or, as superuser         <xhtml:span class=\"inline_block\">          postgres        </xhtml:span>        , executing the SQL command         <xhtml:span class=\"inline_block\">          select pg_reload_conf()        </xhtml:span>        . A denial of service is possible by the over-allocating of limited resources, such as RAM. Data can be corrupted by allowing damaged pages to load or by changing parameters to reinterpret values in an unexpected fashion, e.g. changing the time zone. Client messages can be altered in such a way as to interfere with the application logic. Logging can be altered and obfuscated inhibiting root cause analysis.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74352",
                                                        "artifact_title": "Ensure 'SIGHUP' Runtime Parameters are Configured",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "select name, setting from pg_settings where context = 'sighup' order by 1;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.5_Ensure_Superuser_Runtime_Parameters_are_Configured",
                                        "title": "Ensure 'Superuser' Runtime Parameters are Configured",
                                        "description": "<xhtml:p>  PostgreSQL runtime parameters that can only be executed by the server's superuser, which is traditionally   <xhtml:span class=\"inline_block\">    postgres  </xhtml:span>  .</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Controlled Use of Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  In order to improve and optimize server performance, the server's superuser has the privilege of setting these parameters which are found in the configuration file   <xhtml:span class=\"inline_block\">    postgresql.conf  </xhtml:span>  . Alternatively, they can be changed in a PostgreSQL login session via the SQL command   <xhtml:span class=\"inline_block\">    ALTER SYSTEM  </xhtml:span>   which writes its changes in the configuration file   <xhtml:span class=\"inline_block\">    postgresql.auto.conf  </xhtml:span>  .</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/view-pg-settings.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      The exploit is made in the configuration files. These changes are effected upon server restart. Once detected, the unauthorized/undesired change can be made by editing the altered configuration file and executing a server restart. In the case where the parameter has been set on the command line invocation of       <xhtml:span class=\"inline_block\">        pg_ctl      </xhtml:span>       the       <xhtml:span class=\"inline_block\">        restart      </xhtml:span>       invocation is insufficient and an explicit       <xhtml:span class=\"inline_block\">        stop      </xhtml:span>       and       <xhtml:span class=\"inline_block\">        start      </xhtml:span>       must instead be made.    </xhtml:p>    <xhtml:p>      Detecting a change is possible by one of the following methods:    </xhtml:p>    <xhtml:ol>      <xhtml:li>        Query the view         <xhtml:span class=\"inline_block\">          pg_settings        </xhtml:span>         and compare with previous query outputs for any changes.      </xhtml:li>      <xhtml:li>        Review the configuration files         <xhtml:span class=\"inline_block\">          postgreql.conf        </xhtml:span>         and         <xhtml:span class=\"inline_block\">          postgreql.auto.conf        </xhtml:span>         and compare with previously archived file copies for any changes      </xhtml:li>      <xhtml:li>        Examine the process output and look for parameters that were used at server startup:        <xhtml:code class=\"code_block\">          ps aux | grep -E '[p]ostgres|[p]ostmaster'        </xhtml:code>      </xhtml:li>    </xhtml:ol>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        All changes made on this level will affect the overall behavior of the server. These changes can only be affected by a server restart after the parameters have been altered in the configuration files. A denial of service is possible by the over allocating of limited resources, such as RAM. Data can be corrupted by allowing damaged pages to load or by changing parameters to reinterpret values in an unexpected fashion, e.g. changing the time zone. Client messages can be altered in such a way as to interfere with the application logic. Logging can be altered and obfuscated inhibiting root cause analysis.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74353",
                                                        "artifact_title": "Ensure 'Superuser' Runtime Parameters are Configured",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "select name, setting from pg_settings where context = 'superuser' order by 1;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_User_Runtime_Parameters_are_Configured",
                                        "title": "Ensure 'User' Runtime Parameters are Configured",
                                        "description": "<xhtml:p>  These PostgreSQL runtime parameters are managed at the user account (ROLE) level.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Controlled Use of Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  In order to improve performance and optimize features, a   <xhtml:span class=\"inline_block\">    ROLE  </xhtml:span>   has the privilege of setting numerous parameters in a transaction, session, or as an entity attribute. Any   <xhtml:span class=\"inline_block\">    ROLE  </xhtml:span>   can alter any of these parameters.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/view-pg-settings.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      In the matter of a user session, the login sessions must be validated that it is not executing undesired parameter changes. In the matter of attributes that have been changed in entities, they must be manually reverted to its default value(s).    </xhtml:p>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        A denial of service is possible by the over-allocating of limited resources, such as RAM. Changing         <xhtml:span class=\"inline_block\">          VACUUM        </xhtml:span>         parameters can force a server shutdown which is standard procedure preventing data corruption from transaction ID wraparound. Data can be corrupted by changing parameters to reinterpret values in an unexpected fashion, e.g. changing the time zone. Logging can be altered and obfuscated to inhibit root cause analysis.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74354",
                                                        "artifact_title": "'User' Runtime Parameters",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "select name, setting from pg_settings where context = 'user' order by 1;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_FIPS_140-2_OpenSSL_Cryptography_Is_Used",
                                        "title": "Ensure FIPS 140-2 OpenSSL Cryptography Is Used",
                                        "description": "<xhtml:p>  Install, configure, and use OpenSSL on a platform that has a NIST certified FIPS 140-2 installation of OpenSSL. This provides PostgreSQL instances the ability to generate and validate cryptographic hashes to protect unclassified information requiring confidentiality and cryptographic protection, in accordance with the data owner's requirements.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt All Sensitive Information in Transit",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt All Sensitive Information Over Less-trusted Networks",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Federal Information Processing Standard (FIPS) Publication 140-2 is a computer security standard developed by a U.S. Government and industry working group for validating the quality of cryptographic modules. Use of weak, or untested, encryption algorithms undermine the purposes of utilizing encryption to protect data. PostgreSQL uses OpenSSL for the underlying encryption layer.</xhtml:p><xhtml:p>  The database and application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated. It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.</xhtml:p><xhtml:p>  For detailed information, refer to NIST FIPS Publication 140-2,   <xhtml:em>    Security Requirements for Cryptographic Modules  </xhtml:em>  . Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant. The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A. Currently only Red Hat Enterprise Linux is certified as a FIPS 140-2 distribution of OpenSSL. For other operating systems, users must obtain or build their own FIPS 140-2 OpenSSL libraries.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1758.pdf"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "http://csrc.nist.gov/publications/PubsFIPS.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Configure OpenSSL to be FIPS compliant. PostgreSQL uses OpenSSL for cryptographic modules. To configure OpenSSL to be FIPS 140-2 compliant, see the       <xhtml:a href=\"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard.html\">        official RHEL Documentation      </xhtml:a>      . Below is a general summary of the steps required:    </xhtml:p>    <xhtml:ul>      <xhtml:li>        Install the         <xhtml:span class=\"inline_block\">          dracut-fips        </xhtml:span>         package        <xhtml:code class=\"code_block\">          $ yum -y install dracut-fipsLoaded plugins: fastestmirrorSetting up Install ProcessLoading mirror speeds from cached hostfile * base: mirror.cisp.com * extras: mirror.den1.denvercolo.net * updates: mirror.math.princeton.eduResolving Dependencies--&gt; Running transaction check---&gt; Package dracut-fips.noarch 0:004-411.el6 will be installed--&gt; Processing Dependency: hmaccalc for package: dracut-fips-004-411.el6.noarch--&gt; Running transaction check---&gt; Package hmaccalc.x86_64 0:0.9.12-2.el6 will be installed--&gt; Finished Dependency ResolutionDependencies Resolved================================================================================ Package              Arch            Version               Repository     Size================================================================================Installing: dracut-fips          noarch          004-411.el6           base           38 kInstalling for dependencies: hmaccalc             x86_64          0.9.12-2.el6          base           22 kTransaction Summary================================================================================Install       2 Package(s)Total download size: 60 kInstalled size: 108 kDownloading Packages:(1/2): dracut-fips-004-411.el6.noarch.rpm                |  38 kB     00:00(2/2): hmaccalc-0.9.12-2.el6.x86_64.rpm                  |  22 kB     00:00--------------------------------------------------------------------------------Total                                           334 kB/s |  60 kB     00:00Running rpm_check_debugRunning Transaction TestTransaction Test SucceededRunning Transaction  Installing : hmaccalc-0.9.12-2.el6.x86_64                                 1/2  Installing : dracut-fips-004-411.el6.noarch                               2/2  Verifying  : hmaccalc-0.9.12-2.el6.x86_64                                 1/2  Verifying  : dracut-fips-004-411.el6.noarch                               2/2Installed:  dracut-fips.noarch 0:004-411.el6Dependency Installed:  hmaccalc.x86_64 0:0.9.12-2.el6Complete!        </xhtml:code>      </xhtml:li>      <xhtml:li>        Recreate the         <xhtml:span class=\"inline_block\">          initramfs        </xhtml:span>         file        <xhtml:code class=\"code_block\">          $ dracut -f        </xhtml:code>      </xhtml:li>      <xhtml:li>        Modify the kernel command line of the current kernel in the         <xhtml:span class=\"inline_block\">          /boot/grub/grub.conf        </xhtml:span>         file by adding the following option:         <xhtml:span class=\"inline_block\">          fips=1        </xhtml:span>      </xhtml:li>      <xhtml:li>        Reboot the system for changes to take effect.      </xhtml:li>      <xhtml:li>        Verify         <xhtml:span class=\"inline_block\">          fips_enabled        </xhtml:span>         according to Audit Procedure above.      </xhtml:li>    </xhtml:ul>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74357",
                                                        "artifact_title": "Ensure FIPS 140-2 OpenSSL Cryptography Is Used",
                                                        "artifact": {
                                                            "type": "sce_check_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "script",
                                                                        "dt": "string",
                                                                        "value": "openssl_fips_140-2.sh"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "export_variable_value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "export_variable_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "export_variable_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "null_test_v1",
                                                            "parameters": [
                                                                
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_SSL_is_enabled_and_configured_correctly",
                                        "title": "Ensure SSL is enabled and configured correctly",
                                        "description": "<xhtml:p>  SSL on a PostgreSQL server should be enabled (set to   <xhtml:span class=\"inline_block\">    on  </xhtml:span>  ) and configured to encrypt TCP traffic to and from the server.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt All Sensitive Information in Transit",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt All Sensitive Information Over Less-trusted Networks",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  If SSL is not enabled and configured correctly, this increases the risk of data being compromised in transit.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/ssl-tcp.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r1.pdf"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/libpq-ssl.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      For this example, and ease of illustration, we will be using a self-signed certificate for the server generated via       <xhtml:span class=\"inline_block\">        openssl      </xhtml:span>      , and the PostgreSQL defaults for file naming and location in the PostgreSQL       <xhtml:span class=\"inline_block\">        $PGDATA      </xhtml:span>       directory.    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      postgres      <br/>      $ # create new certificate and enter details at prompts      <br/>      $ openssl req -new -text -out server.req      <br/>      Generating a 2048 bit RSA private key      <br/>      .....................+++      <br/>      ..................................................................+++      <br/>      writing new private key to 'privkey.pem'      <br/>      Enter PEM pass phrase:      <br/>      Verifying - Enter PEM pass phrase:      <br/>      -----      <br/>      You are about to be asked to enter information that will be incorporated      <br/>      into your certificate request.      <br/>      What you are about to enter is what is called a Distinguished Name or a DN.      <br/>      There are quite a few fields but you can leave some blank      <br/>      For some fields there will be a default value,      <br/>      If you enter '.', the field will be left blank.      <br/>      -----      <br/>      Country Name (2 letter code) [XX]:US      <br/>      State or Province Name (full name) []:Ohio      <br/>      Locality Name (eg, city) [Default City]:Columbus      <br/>      Organization Name (eg, company) [Default Company Ltd]:Me Inc      <br/>      Organizational Unit Name (eg, section) []:IT      <br/>      Common Name (eg, your name or your server's hostname) []:my.me.inc      <br/>      Email Address []:me@meinc.com      <br/>      <br/>      Please enter the following 'extra' attributes      <br/>      to be sent with your certificate request      <br/>      A challenge password []:      <br/>      An optional company name []:      <br/>      <br/>      $ # remove passphrase (required for automatic server start up)      <br/>      $ openssl rsa -in privkey.pem -out server.key &amp;&amp; rm privkey.pem      <br/>      Enter pass phrase for privkey.pem:      <br/>      writing RSA key      <br/>      <br/>      $ # modify certificate to self signed, generate .key and .crt files      <br/>      $ openssl req -x509 -in server.req -text -key server.key -out server.crt      <br/>      <br/>      $ # copy .key and .crt files to appropriate location, here default $PGDATA      <br/>      $ cp server.key server.crt $PGDATA      <br/>      <br/>      $ # restrict file mode for server.key      <br/>      $ chmod og-rwx server.key    </xhtml:code>    <xhtml:p>      Edit the PostgreSQL configuration file       <xhtml:span class=\"inline_block\">        postgresql.conf      </xhtml:span>       to ensure the following items are set. Again, we are using defaults. Note that altering these parameters will require restarting the cluster.    </xhtml:p>    <xhtml:code class=\"code_block\">      # (change requires restart)      <br/>      ssl = on      <br/>      <br/>      # allowed SSL ciphers      <br/>      ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL'      <br/>      <br/>      # (change requires restart)      <br/>      ssl_cert_file = 'server.crt'      <br/>      <br/>      # (change requires restart)      <br/>      ssl_key_file = 'server.key'      <br/>      <br/>      password_encryption = on    </xhtml:code>    <xhtml:p>      Finally, restart PostgreSQL and confirm       <xhtml:span class=\"inline_block\">        ssl      </xhtml:span>       using commands outlined in Audit Procedures:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# show ssl;      <br/>       ssl      <br/>      -----      <br/>       on      <br/>      (1 row)    </xhtml:code>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        A self-signed certificate can be used for testing, but a certificate signed by a certificate authority (CA) (either one of the global CAs or a local one) should be used in production so that clients can verify the server's identity. If all the database clients are local to the organization, using a local CA is recommended.      </xhtml:p>      <xhtml:p>        To ultimately enable and enforce         <xhtml:span class=\"inline_block\">          ssl        </xhtml:span>         authentication for the server, appropriate         <xhtml:span class=\"inline_block\">          hostssl        </xhtml:span>         records must be added to the         <xhtml:span class=\"inline_block\">          pg_hba.conf        </xhtml:span>         file. Be sure to         <xhtml:span class=\"inline_block\">          reload        </xhtml:span>         PostgreSQL after any changes (restart not required).      </xhtml:p>      <xhtml:p>        <xhtml:strong>          Note:        </xhtml:strong>         The         <xhtml:span class=\"inline_block\">          hostssl        </xhtml:span>         record matches connection attempts made using TCP/IP, but         <xhtml:strong>          only        </xhtml:strong>         when the connection is made with SSL encryption. The         <xhtml:span class=\"inline_block\">          host        </xhtml:span>         record matches attempts made using TCP/IP, but allows both SSL and non-SSL connections. The         <xhtml:span class=\"inline_block\">          hostnossl        </xhtml:span>         record matches attempts made using TCP/IP, but only those         <xhtml:em>          without        </xhtml:em>         SSL.         <xhtml:em>          Care should be taken to enforce SSL as appropriate.        </xhtml:em>      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74356",
                                                        "artifact_title": "Ensure SSL is enabled and configured correctly",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "show ssl;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": "on"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": "ssl"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_the_pgcrypto_extension_is_installed_and_configured_correctly",
                                        "title": "Ensure the pgcrypto extension is installed and configured correctly",
                                        "description": "<xhtml:p>  PostgreSQL must implement cryptographic mechanisms to prevent unauthorized disclosure or modification of organization-defined information at rest (to include, at a minimum, PII and classified information) on organization-defined information system components.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt Sensitive Information at Rest",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:8",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt At Rest Sensitive Information",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:5",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  PostgreSQL handling data that requires \"data at rest\" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to PostgreSQL or implemented via additional software or operating system/file system settings, as appropriate to the situation. Information at rest refers to the state of information when it is located on a secondary storage device (e.g. disk drive, tape drive) within an organizational information system.</xhtml:p><xhtml:p>  Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e. full disk encryption) or encrypt specific data structures (e.g. files, records, or fields). Organizations may also optionally choose to implement both to implement layered security.</xhtml:p><xhtml:p>  The decision whether, and what, to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate. If the confidentiality and integrity of application data is not protected, the data will be open to compromise and unauthorized modification.</xhtml:p><xhtml:p>  The PostgreSQL   <xhtml:span class=\"inline_block\">    pgcrypto  </xhtml:span>   extension provides cryptographic functions for PostgreSQL and is intended to address the confidentiality and integrity of user and system information at rest in non-mobile devices.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/5"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "http://www.postgresql.org/docs/9.6/static/pgcrypto.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      The       <xhtml:span class=\"inline_block\">        pgcrypto      </xhtml:span>       extension is included with the PostgreSQL 'contrib' package. Although included, it needs to be created in the database.    </xhtml:p>    <xhtml:p>      As the database administrator, run the following:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# CREATE EXTENSION pgcrypto;      <br/>      CREATE EXTENSION    </xhtml:code>    <xhtml:p>      Verify       <xhtml:span class=\"inline_block\">        pgcrypto      </xhtml:span>       is installed:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# SELECT * FROM pg_available_extensions WHERE name='pgcrypto';      <br/>         name   | default_version | installed_version |         comment      <br/>      ----------+-----------------+-------------------+-------------------------      <br/>       pgcrypto | 1.3             | 1.3               | cryptographic functions      <br/>      (1 row)    </xhtml:code>    <xhtml:p class=\"bold\">      Impact:    </xhtml:p>    <xhtml:p>      <xhtml:p>        When considering or undertaking any form of encryption, it is critical to understand the state of the encrypted data at all stages of the data lifecycle. The use of         <xhtml:span class=\"inline_block\">          pgcrypto        </xhtml:span>         ensures that the data at rest in the tables (and therefore on disk) is encrypted, but for the data to be accessed by any users or applications, said users/applications will, by necessity, have access to the encrypt and decrypt keys and the data in question will be encrypted/decrypted in memory and then transferred to/from the user/application in that form.      </xhtml:p>    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74355",
                                                        "artifact_title": "Ensure the pgcrypto extension is installed and configured correctly",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "SELECT * FROM pg_available_extensions where name='pgcrypto';"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_7_Replication",
                    "title": "Replication",
                    "description": "<xhtml:p>  Data redundancy often plays a major role as part of an overall database strategy. Replication is an example of data redundancy and fulfills both High Availability and High Performance requirements. However, although the DBA may have expended much time and effort securing the PRIMARY host and taken the time to harden STANDBY configuration parameters, one sometimes overlooks the medium transmitting the data itself over the network. Consequently, replication is an appealing attack vector given that all DDL, and DML operations executed on the PRIMARY, or master, host is sent over the wire to the SECONDARY/STANDBY, or slave, hosts. Fortunately, when correctly understood, defeating such attacks can be implemented in a straight forward manner. This benchmark reviews those issues surrounding the most common mechanisms of replicating data between hosts. There are several PostgreSQL replication mechanisms and includes:</xhtml:p><xhtml:ul>  <xhtml:li>    Warm Standby (also known as LOG Shipping)    <xhtml:ul>      <xhtml:li>        Transaction logs are copied from the PRIMARY to SECONDARY host that reads the logs in a \"recovery\" mode. For all intents and purposes the host ingesting the WAL cannot be read i.e. it's off-line.      </xhtml:li>    </xhtml:ul>  </xhtml:li>  <xhtml:li>    Hot Standby    <xhtml:ul>      <xhtml:li>        Operates in the exact same fashion as the Warm Standby Server except that, in addition, it offers a read-only environment for client connections to connect and query.      </xhtml:li>    </xhtml:ul>  </xhtml:li>  <xhtml:li>    Point In Time Recovery (PITR)    <xhtml:ul>      <xhtml:li>        Primarily used for database forensics and recovery at particular points in time such as in the case that important data may have been accidentally removed. One can restore the cluster to a point in time before the event occurred.      </xhtml:li>    </xhtml:ul>  </xhtml:li>  <xhtml:li>    Streaming Replication    <xhtml:ul>      <xhtml:li>        Uses an explicit connection, which in a manner of speaking is similar to the standard client connection, between the PRIMARY and STANDBY host. It too reads the transaction logs and ingests into a read-only server. What's different is that the connection uses a special replication protocol which is faster and more efficient than log shipping. Similar to standard client connections, it also honors the same authentication rules as expressed in the PostgreSQL host-based authentication file,         <xhtml:span class=\"inline_block\">          pg_hba.conf        </xhtml:span>        .      </xhtml:li>    </xhtml:ul>  </xhtml:li></xhtml:ul>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_SSL_Certificates_are_Configured_For_Replication",
                                        "title": "Ensure SSL Certificates are Configured For Replication",
                                        "description": "<xhtml:p>  Creating and managing SSL certificates on the PRIMARY and STANDBY host(s).</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt All Sensitive Information in Transit",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt All Sensitive Information Over Less-trusted Networks",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Secure Sockets Layer (SSL) certificates enable encrypted communications between the PRIMARY and STANDBY hosts. SSL certificates can also be used to authenticate the identity of the host. The use of SSL certificates mitigates against sniffing of what would otherwise be sensitive information that's being transmitted in the clear.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/current/static/runtime-config-connection.html#RUNTIME-CONFIG-CONNECTION-SECURITY"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://linux.die.net/man/1/openssl"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Running a server with       <xhtml:span class=\"inline_block\">        ssl=on      </xhtml:span>       is not possible until both a server certificate and key have been created, installed in the correct location, and are set with the correct permissions.    </xhtml:p>    <xhtml:p>      Although generating certificates signed by a Certificate Authority, CA is ideal, one can use self-signed certificates too.    </xhtml:p>    <xhtml:p>      Use the following example as a starting point to generate a self-signed certificate, the script is executed on the server in question. Note that the value of the       <xhtml:span class=\"inline_block\">        SUBJ      </xhtml:span>       variable contains a carriage return to allow for formatting - the entire value should appear on a single line in the script.    </xhtml:p>    <xhtml:code class=\"code_block\">      #!/bin/bash      <br/>      <br/>      set -e      <br/>      <br/>      state='Washington'      <br/>      city='Seattle'      <br/>      organization='My Company'      <br/>      org_unit='My department'      <br/>      cn=$(hostname -f)      <br/>      email='you@company.com'      <br/>      <br/>      SUBJ=\"/C=US/ST=$state/L=$city/O=$organization/      <br/>            OU=$org_unit/CN=$cn/emailAddress=$email\"      <br/>      <br/>      # Expire in 10 yrs      <br/>      DAYS=3650      <br/>      <br/>      if [ -e \"$PGDATA\" ]; then      <br/>        KEY=\"$PGDATA/server.key\"      <br/>        CRT=\"$PGDATA/server.crt\"      <br/>      else      <br/>        KEY=\"server.key\"      <br/>        CRT=\"server.crt\"      <br/>      fi      <br/>      <br/>      openssl  req \\      <br/>              -nodes \\      <br/>              -x509 \\      <br/>              -newkey rsa:2048 \\      <br/>              -keyout $KEY \\      <br/>              -out $CRT \\      <br/>              -days $DAYS \\      <br/>              -subj \"$SUBJ\"      <br/>      <br/>      chmod 600 $KEY      <br/>      chmod 664 $CRT      <br/>      <br/>      echo \"DONE\"    </xhtml:code>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74358",
                                                        "artifact_title": "Verify existence of ssl_cert_file",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "show ssl_cert_file;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": "server.crt"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": "ssl_cert_file"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                },
                                                {
                                                    "and": [
                                                        {
                                                            "artifact-expression": {
                                                                "artifact-unique-id": "74359",
                                                                "artifact_title": "Verify existence of ssl_key_file",
                                                                "artifact": {
                                                                    "type": "independent.sql57_v1",
                                                                    "parameters": [
                                                                        {
                                                                            "parameter": {
                                                                                "name": "engine",
                                                                                "dt": "string",
                                                                                "value": "postgre"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "sql",
                                                                                "dt": "string",
                                                                                "value": "show ssl_key_file;"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "version",
                                                                                "dt": "string",
                                                                                "value": "9.6"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "prepend_str",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "append_str",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "prepend_type",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "append_type",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        }
                                                                    ]
                                                                },
                                                                "test": {
                                                                    "type": "independent.sql57_v1",
                                                                    "parameters": [
                                                                        {
                                                                            "parameter": {
                                                                                "name": "check_existence",
                                                                                "dt": "string",
                                                                                "value": "at_least_one_exists"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "check",
                                                                                "dt": "string",
                                                                                "value": "all"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "value",
                                                                                "dt": "string",
                                                                                "value": "server.key"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "value_data_type",
                                                                                "dt": "string",
                                                                                "value": "string"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "field_name",
                                                                                "dt": "string",
                                                                                "value": "ssl_key_file"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "field_operation",
                                                                                "dt": "string",
                                                                                "value": "equals"
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "artifact-expression": {
                                                                "artifact-unique-id": "74360",
                                                                "artifact_title": "Confirm ssl",
                                                                "artifact": {
                                                                    "type": "independent.sql57_v1",
                                                                    "parameters": [
                                                                        {
                                                                            "parameter": {
                                                                                "name": "engine",
                                                                                "dt": "string",
                                                                                "value": "postgre"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "sql",
                                                                                "dt": "string",
                                                                                "value": "show ssl;"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "version",
                                                                                "dt": "string",
                                                                                "value": "9.6"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "prepend_str",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "append_str",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "prepend_type",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "append_type",
                                                                                "dt": "string",
                                                                                "value": ""
                                                                            }
                                                                        }
                                                                    ]
                                                                },
                                                                "test": {
                                                                    "type": "independent.sql57_v1",
                                                                    "parameters": [
                                                                        {
                                                                            "parameter": {
                                                                                "name": "check_existence",
                                                                                "dt": "string",
                                                                                "value": "at_least_one_exists"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "check",
                                                                                "dt": "string",
                                                                                "value": "all"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "value",
                                                                                "dt": "string",
                                                                                "value": "on"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "value_data_type",
                                                                                "dt": "string",
                                                                                "value": "string"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "field_name",
                                                                                "dt": "string",
                                                                                "value": "ssl"
                                                                            }
                                                                        },
                                                                        {
                                                                            "parameter": {
                                                                                "name": "field_operation",
                                                                                "dt": "string",
                                                                                "value": "equals"
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_a_replication-only_user_is_created_and_used_for_streaming_replication",
                                        "title": "Ensure a replication-only user is created and used for streaming replication",
                                        "description": "<xhtml:p>  Create a new user specifically for use by streaming replication instead of using the superuser account.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Minimize And Sparingly Use Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:6.0:5:1",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Controlled Use of Administrative Privileges",
                                                        "urn": "urn:cisecurity.org:controls:7.0:4"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  As it is not necessary to be a superuser to initiate a replication connection, it is proper to create an account specifically for replication. This allows further 'locking down' the uses of the superuser account and follows the general principle of using the least privileges necessary.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/app-pgbasebackup.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/standby-settings.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      It will be necessary to create a new role for replication purposes:    </xhtml:p>    <xhtml:code class=\"code_block\">      postgres=# create user replication_user REPLICATION encrypted password 'XXX';      <br/>      CREATE ROLE      <br/>      postgres=# select rolname from pg_roles where rolreplication is true;      <br/>           rolname      <br/>      ------------------      <br/>       postgres      <br/>       replication_user      <br/>      (2 rows)    </xhtml:code>    <xhtml:p>      When using       <xhtml:span class=\"inline_block\">        pg_basebackup      </xhtml:span>       (or other replication tools) and when configuring       <xhtml:span class=\"inline_block\">        recovery.conf      </xhtml:span>       on your standby server, you would use the       <xhtml:span class=\"inline_block\">        replication_user      </xhtml:span>       (and its password).    </xhtml:p>    <xhtml:p>      Ensure you allow the new user via your       <xhtml:span class=\"inline_block\">        pg_hba.conf      </xhtml:span>       file:    </xhtml:p>    <xhtml:code class=\"code_block\">      # note that 'replication' in the 2nd column is required and is a special      <br/>      # keyword, not a real database      <br/>      hostssl replication     replication_user       0.0.0.0/0               md5    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_base_backups_are_configured_and_functional",
                                        "title": "Ensure base backups are configured and functional",
                                        "description": "<xhtml:p>  A 'base backup' is a copy of the PRIMARY host's data cluster ($PGDATA) and is used to create STANDBY hosts and for Point In Time Recovery (PITR) mechanisms. Base backups should be copied across networks in a secure manner using an encrypted transport mechanism. CLI examples includes   <xhtml:span class=\"inline_block\">    scp  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    sftp  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    rsync -e ssh  </xhtml:span>  . Alternatively, the CLI   <xhtml:span class=\"inline_block\">    cp  </xhtml:span>   can be used with an SSL-enabled implementation of an NFS mount point, or the PostgreSQL CLI   <xhtml:span class=\"inline_block\">    pg_basebackup  </xhtml:span>   can be used. However, SSL encryption should be enabled on the server. Beware it is possible to use this utility without SSL encryption enabled.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Test Data on Backup Media",
                                                        "urn": "urn:cisecurity.org:controls:7.0:10:3",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Test Backups Regularly",
                                                        "urn": "urn:cisecurity.org:controls:6.0:10:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/10/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/3"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/app-pgbasebackup.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      There are two methods of creating base backups; manual and simple. The \"manual\" method explicitly first signals that a backup is about to start, then copies both the data cluster and WALs, using the appropriate tools/utilities, and finally signaling the PRIMARY host the copy process has finished and the backup has finished.    </xhtml:p>    <xhtml:code class=\"code_block\">       postgres=# SELECT pg_start_backup('my base backup');      <br/>        pg_start_backup      <br/>       -----------------      <br/>        0/2000028      <br/>       (1 row)    </xhtml:code>    <xhtml:code class=\"code_block\">         # copy both the data cluster and       <br/>         # all WALs generated during the process      <br/>         # ex:      <br/>         $ scp -rp $PGDATA user@dest:/path    </xhtml:code>    <xhtml:code class=\"code_block\">       postgres=# SELECT pg_stop_backup();      <br/>        pg_start_backup      <br/>       -----------------      <br/>        0/2000030      <br/>       (1 row)    </xhtml:code>    <xhtml:p>      Executing base backups using       <xhtml:span class=\"inline_block\">        pg_basebackup      </xhtml:span>       requires the following steps on the       <xhtml:strong>        standby      </xhtml:strong>       server:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      postgres      <br/>      $ pg_basebackup -h name_or_IP_of_master \\      <br/>      -p 5432 \\      <br/>      -U replication_user \\      <br/>      -D ~postgres/9.6/data \\      <br/>      -P -v -R -XS \\    </xhtml:code>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_7.4_Ensure_WAL_archiving_is_configured_and_functional",
                                        "title": "Ensure WAL archiving is configured and functional",
                                        "description": "<xhtml:p>  Write Ahead Log (WAL) Archiving, or Log Shipping, is the process of sending transaction log files from the PRIMARY host either to one or more STANDBY hosts or to be archived on a remote storage device for later use, e.g.   <xhtml:span class=\"inline_block\">    PITR  </xhtml:span>  . There are several utilities that can copy WALs including, but not limited to,   <xhtml:span class=\"inline_block\">    cp  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    scp  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    sftp  </xhtml:span>  , and   <xhtml:span class=\"inline_block\">    rynsc  </xhtml:span>  . Basically, the server follows a set of runtime parameters which defines when the WAL should be copied using one of the aforementioned utilities.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt All Sensitive Information in Transit",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt All Sensitive Information Over Less-trusted Networks",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Unless the server has been correctly configured, one runs the risk of sending WALs in an unsecured, unencrypted fashion.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-wal.html#RUNTIME-CONFIG-WAL-ARCHIVING"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://linux.die.net/man/1/ssh-keygen"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Change parameters and restart the server as required.    </xhtml:p>    <xhtml:p>      <xhtml:strong>        Note:      </xhtml:strong>       SSH public keys must be generated and installed as per industry standards.    </xhtml:p>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74361",
                                                        "artifact_title": "Ensure WAL archiving is configured and functional",
                                                        "artifact": {
                                                            "type": "independent.text_file_content_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "path",
                                                                        "dt": "string",
                                                                        "value": "~/postgres/"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "filename",
                                                                        "dt": "string",
                                                                        "value": "postgresql.conf"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "recurse",
                                                                        "dt": "string",
                                                                        "value": "NA"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "max_depth",
                                                                        "dt": "int",
                                                                        "value": "-1"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "file_system",
                                                                        "dt": "string",
                                                                        "value": "local"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "pattern",
                                                                        "dt": "string",
                                                                        "value": "(?<=^archive_mode\\s?=\\s?).+$"
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "pattern match",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": "(?i)^on$"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                },
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74362",
                                                        "artifact_title": "Ensure SSH as a transport medium",
                                                        "artifact": {
                                                            "type": "independent.text_file_content_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "path",
                                                                        "dt": "string",
                                                                        "value": "~/postgres/"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "filename",
                                                                        "dt": "string",
                                                                        "value": "postgresql.conf"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "recurse",
                                                                        "dt": "string",
                                                                        "value": "NA"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "max_depth",
                                                                        "dt": "int",
                                                                        "value": "-1"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "file_system",
                                                                        "dt": "string",
                                                                        "value": "local"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "pattern",
                                                                        "dt": "string",
                                                                        "value": "(?<=(?i)^archive_command\\s=\\s).+$"
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "pattern match",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": "^'rsync.+-e ssh.*'$"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_7.5_Ensure_streaming_replication_parameters_are_configured_correctly",
                                        "title": "Ensure streaming replication parameters are configured correctly",
                                        "description": "<xhtml:p>  Streaming replication from a PRIMARY host transmits DDL, DML, passwords, and other potentially sensitive activities and data. These connections should be protected with Secure Sockets Layer (SSL).</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Encrypt All Sensitive Information in Transit",
                                                        "urn": "urn:cisecurity.org:controls:7.0:14:4",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Encrypt All Sensitive Information Over Less-trusted Networks",
                                                        "urn": "urn:cisecurity.org:controls:6.0:14:2",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Unencrypted transmissions could reveal sensitive information to unauthorized parties. Unauthenticated connections could enable man-in-the-middle attacks.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-connection.html#RUNTIME-CONFIG-CONNECTION-SECURITY"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/app-pgbasebackup.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-wal.html#RUNTIME-CONFIG-WAL-ARCHIVING"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://linux.die.net/man/1/openssl"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Review prior sections in this benchmark regarding SSL certificates, replication user, and WAL archiving.    </xhtml:p>    <xhtml:p>      Confirm the file       <xhtml:span class=\"inline_block\">        recovery.conf      </xhtml:span>       is present on the STANDBY host and contains lines similar to the following:    </xhtml:p>    <xhtml:code class=\"code_block\">      standby_mode=on      <br/>      primary_conninfo = 'user=replication_user password=mypassword host=mySrcHost port=5432 sslmode=require sslcompression=1'    </xhtml:code>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74363",
                                                        "artifact_title": "List Postgres roles",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "SELECT r.rolname, r.rolsuper, r.rolinherit, r.rolcreaterole, r.rolcreatedb, r.rolcanlogin, r.rolconnlimit, ARRAY(SELECT b.rolname FROM pg_catalog.pg_auth_members m JOIN pg_catalog.pg_roles b ON (m.roleid = b.oid) WHERE m.member = r.oid) as memberof FROM pg_catalog.pg_roles r ORDER BY 1;"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "string"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            {
                "Group": {
                    "id": "xccdf_org.cisecurity.benchmarks_group_8_Special_Configuration_Considerations",
                    "title": "Special Configuration Considerations",
                    "description": "<xhtml:p>  The recommendations proposed here are to try and address some of the less come use cases which may warrant additional configuration guidance/consideration.</xhtml:p>",
                    "Groups": [
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_PostgreSQL_configuration_files_are_outside_the_data_cluster",
                                        "title": "Ensure PostgreSQL configuration files are outside the data cluster",
                                        "description": "<xhtml:p>  PostgreSQL configuration files within the data cluster's directory tree can be changed by anyone logging into the data cluster as the superuser, i.e.   <xhtml:span class=\"inline_block\">    postgres  </xhtml:span>  . As a matter of default policy, configuration files such as   <xhtml:span class=\"inline_block\">    postgresql.conf  </xhtml:span>  ,   <xhtml:span class=\"inline_block\">    pg_hba.conf  </xhtml:span>  , and   <xhtml:span class=\"inline_block\">    pg_ident  </xhtml:span>  , are placed in the data cluster's directory,   <xhtml:span class=\"inline_block\">    $PGDATA  </xhtml:span>  . PostgreSQL can be configured to relocate these files to locations outside the data cluster which cannot then be accessed by an ordinary superuser login session.</xhtml:p><xhtml:p>  Consideration should also be given to \"include directives\"; these are cluster subdirectories where one can locate files containing additional configuration parameters. Include directives are meant to add more flexibility for unique installs or large network environments while maintaining order and consistent architectural design.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Use Standard Hardening Configuration Templates for Databases",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18:11",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Use Standard Database Hardening Templates",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18:7",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Leaving PostgreSQL configuration files within the data cluster's directory tree increases the changes that they will be inadvertently or intentionally altered.</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/7"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-file-locations.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-connection.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/config-setting.html#CONFIG-INCLUDES"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Follow these steps to remediate the configuration file locations and permissions:    </xhtml:p>    <xhtml:ul>      <xhtml:li>        Determine appropriate locations for relocatable configuration files based on your organization's security policies. If necessary, relocate and/or rename configuration files outside of the data cluster.      </xhtml:li>      <xhtml:li>        Ensure their file permissions are restricted as much as possible, i.e. only superuser read access.      </xhtml:li>      <xhtml:li>        Change the settings accordingly in the         <xhtml:span class=\"inline_block\">          postgresql.conf        </xhtml:span>         configuration file.      </xhtml:li>      <xhtml:li>        Restart the database cluster for the changes to take effect.      </xhtml:li>    </xhtml:ul>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74364",
                                                        "artifact_title": "Ensure PostgreSQL configuration files are outside the data cluster",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "SELECT name, setting FROM pg_settings WHERE name IN ('hba_file','ident_file','ssl_cert_file','ssl_key_file','ssl_ca_file','ssl_crl_file','krb_server_keyfile');"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_8.2_Ensure_PostgreSQL_subdirectory_locations_are_outside_the_data_cluster",
                                        "title": "Ensure PostgreSQL subdirectory locations are outside the data cluster",
                                        "description": "<xhtml:p>  The PostgreSQL cluster is organized to carry out specific tasks in subdirectories. For the purposes of performance, reliability, and security these subdirectories should be relocated outside the data cluster.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Use Standard Hardening Configuration Templates for Databases",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18:11",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Use Standard Database Hardening Templates",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18:7",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  Some subdirectories contain information, such as logs, which can be of value to others such as developers. Other subdirectories can gain a performance benefit when placed on fast storage devices. Finally, relocating a subdirectory to a separate and distinct partition mitigates denial of service and involuntary server shutdown when excessive writes fill the data cluster's partition, e.g.   <xhtml:span class=\"inline_block\">    pg_xlog  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    pg_log  </xhtml:span>  .</xhtml:p>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/7"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-file-locations.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Perform the following steps to remediate the subdirectory locations and permissions:    </xhtml:p>    <xhtml:ul>      <xhtml:li>        Determine appropriate data, log, and tablespace directories and locations based on your organization's security policies. If necessary, relocate all listed directories outside the data cluster.      </xhtml:li>      <xhtml:li>        Ensure file permissions are restricted as much as possible, i.e. only superuser read access.      </xhtml:li>      <xhtml:li>        When directories are relocated to other partitions, ensure that they are of sufficient size to mitigate against excessive space utilization.      </xhtml:li>      <xhtml:li>        Lastly, change the settings accordingly in the         <xhtml:span class=\"inline_block\">          postgresql.conf        </xhtml:span>         configuration file and restart the database cluster for changes to take effect.      </xhtml:li>    </xhtml:ul>  </xhtml:p></xhtml:div>",
                                        "checks": {
                                            "and": [
                                                {
                                                    "artifact-expression": {
                                                        "artifact-unique-id": "74365",
                                                        "artifact_title": "Ensure PostgreSQL subdirectory locations are outside the data cluster",
                                                        "artifact": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "engine",
                                                                        "dt": "string",
                                                                        "value": "postgre"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "sql",
                                                                        "dt": "string",
                                                                        "value": "SELECT name, setting FROM pg_settings WHERE name IN ('data_directory','log_directory' ,'default_tablespace' ,'temp_tablespaces');"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "version",
                                                                        "dt": "string",
                                                                        "value": "9.6"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_str",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "prepend_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "append_type",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        "test": {
                                                            "type": "independent.sql57_v1",
                                                            "parameters": [
                                                                {
                                                                    "parameter": {
                                                                        "name": "check_existence",
                                                                        "dt": "string",
                                                                        "value": "at_least_one_exists"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "check",
                                                                        "dt": "string",
                                                                        "value": "all"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "value_data_type",
                                                                        "dt": "string",
                                                                        "value": "boolean"
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_name",
                                                                        "dt": "string",
                                                                        "value": ""
                                                                    }
                                                                },
                                                                {
                                                                    "parameter": {
                                                                        "name": "field_operation",
                                                                        "dt": "string",
                                                                        "value": "equals"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_8.3_Ensure_the_backup_and_restore_tool_pgBackRest_is_installed_and_configured",
                                        "title": "Ensure the backup and restore tool, 'pgBackRest', is installed and configured",
                                        "description": "<xhtml:p>  pgBackRest aims to be a simple, reliable backup and restore system that can seamlessly scale up to the largest databases and workloads. Instead of relying on traditional backup tools like   <xhtml:span class=\"inline_block\">    tar  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    rsync  </xhtml:span>  , pgBackRest implements all backup features internally and uses a custom protocol for communicating with remote systems. Removing reliance on   <xhtml:span class=\"inline_block\">    tar  </xhtml:span>   and   <xhtml:span class=\"inline_block\">    rsync  </xhtml:span>   allows for better solutions to database-specific backup challenges. The custom remote protocol allows for more flexibility and limits the types of connections that are required to perform a backup which increases security.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Ensure Regular Automated Back Ups",
                                                        "urn": "urn:cisecurity.org:controls:7.0:10:1",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    },
                                                    {
                                                        "title": "Perform Complete System Backups",
                                                        "urn": "urn:cisecurity.org:controls:7.0:10:2",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "true",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "Data",
                                                        "securityFunction": "Protect"
                                                    }
                                                ],
                                                "control": [
                                                    {
                                                        "title": "Data Recovery Capability",
                                                        "urn": "urn:cisecurity.org:controls:6.0:10"
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "<xhtml:p>  The native PostgreSQL backup facility   <xhtml:span class=\"inline_block\">    pg_dump  </xhtml:span>   provides adequate logical backup operations but does not provide for Point In Time Recovery (PITR). The PostgreSQL facility   <xhtml:span class=\"inline_block\">    pg_basebackup  </xhtml:span>   performs physical backup of the database files and does provide for PITR, but it is constrained by single threading. Both of these methodologies are standard in the PostgreSQL ecosystem and appropriate for particular backup/recovery needs.   <xhtml:span class=\"inline_block\">    pgBackRest  </xhtml:span>   offers another option with much more robust features and flexibility.</xhtml:p><xhtml:p>  <xhtml:span class=\"inline_block\">    pgBackRest  </xhtml:span>   is open source software developed to perform efficient backups on PostgreSQL databases that measure in tens of terabytes and greater. It supports per file checksums, compression, partial/failed backup resume, high-performance parallel transfer, asynchronous archiving, tablespaces, expiration, full/differential/incremental, local/remote operation via SSH, hard-linking, restore,   <xhtml:strong>    backup encryption  </xhtml:strong>  , and more.   <xhtml:span class=\"inline_block\">    pgBackRest  </xhtml:span>   is written in C and Perl and does not depend on   <xhtml:span class=\"inline_block\">    rsync  </xhtml:span>   or   <xhtml:span class=\"inline_block\">    tar  </xhtml:span>   but instead performs its own deltas which gives it maximum flexibility. Finally,   <xhtml:span class=\"inline_block\">    pgBackRest  </xhtml:span>   provides an easy to use internal repository listing backup details accessible via the   <xhtml:span class=\"inline_block\">    pgbackrest info  </xhtml:span>   command, as illustrated below.</xhtml:p><xhtml:code class=\"code_block\">  $ pgbackrest info  <br/>  stanza: proddb01  <br/>  status: ok  <br/>  <br/>  db (current)  <br/>    wal archive min/max (9.6-1): 000000010000000000000012 / 000000010000000000000017  <br/>  <br/>          full backup: 20181002-153106F  <br/>              timestamp start/stop: 2018-10-02 15:31:06 / 2018-10-02 15:31:49  <br/>              wal start/stop: 000000010000000000000012 / 000000010000000000000012  <br/>              database size: 29.4MB, backup size: 29.4MB  <br/>              repository size: 3.4MB, repository backup size: 3.4MB  <br/>  <br/>          diff backup: 20181002-153106F_20181002-173109D  <br/>              timestamp start/stop: 2018-10-02 17:31:09 / 2018-10-02 17:31:19  <br/>              wal start/stop: 000000010000000000000015 / 000000010000000000000015  <br/>              database size: 29.4MB, backup size: 2.6MB  <br/>              repository size: 3.4MB, repository backup size: 346.8KB  <br/>              backup reference list: 20181002-153106F  <br/>  <br/>          incr backup: 20181002-153106F_20181002-183114I  <br/>              timestamp start/stop: 2018-10-02 18:31:14 / 2018-10-02 18:31:22  <br/>              wal start/stop: 000000010000000000000017 / 000000010000000000000017  <br/>              database size: 29.4MB, backup size: 8.2KB  <br/>              repository size: 3.4MB, repository backup size: 519B  <br/>              backup reference list: 20181002-153106F, 20181002-153106F_20181002-173109D</xhtml:code>",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/10"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/1"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/2"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://pgbackrest.org/"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://github.com/pgbackrest/pgbackrest"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/app-pgdump.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/app-pgbasebackup.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      <xhtml:span class=\"inline_block\">        pgBackRest      </xhtml:span>       is not installed nor configured for PostgreSQL by default, but instead is maintained as a GitHub project. Fortunately, it is a part of the PGDG repository and can be easily installed:    </xhtml:p>    <xhtml:code class=\"code_block\">      $ whoami      <br/>      root      <br/>      $ yum -y install pgbackrest.x86_64      <br/>      Loaded plugins: fastestmirror      <br/>      Setting up Install Process      <br/>      Loading mirror speeds from cached hostfile      <br/>       * base: centos.mirrors.tds.net      <br/>       * extras: mirror.cs.vt.edu      <br/>       * updates: mirror.cs.pitt.edu      <br/>      Resolving Dependencies      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package pgbackrest.x86_64 0:2.05-1.rhel6 will be installed      <br/>      --&gt; Processing Dependency: perl-parent for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Processing Dependency: perl-XML-LibXML for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Processing Dependency: perl-Time-HiRes for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Processing Dependency: perl-JSON for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Processing Dependency: perl-IO-Socket-SSL for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Processing Dependency: perl-Digest-SHA for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Processing Dependency: perl-DBD-Pg for package: pgbackrest-2.05-1.rhel6.x86_64      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package perl-DBD-Pg.x86_64 0:2.15.1-4.el6_3 will be installed      <br/>      --&gt; Processing Dependency: perl(DBI) for package: perl-DBD-Pg-2.15.1-4.el6_3.x86_64      <br/>      ---&gt; Package perl-Digest-SHA.x86_64 1:5.47-144.el6 will be installed      <br/>      ---&gt; Package perl-IO-Socket-SSL.noarch 0:1.31-3.el6_8.2 will be installed      <br/>      --&gt; Processing Dependency: perl-Net-SSLeay &gt;= 1.35-10.el6_8.1 for package: perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch      <br/>      --&gt; Processing Dependency: perl(Net::LibIDN) for package: perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch      <br/>      ---&gt; Package perl-JSON.noarch 0:2.15-5.el6 will be installed      <br/>      --&gt; Processing Dependency: perl(LWP::UserAgent) for package: perl-JSON-2.15-5.el6.noarch      <br/>      --&gt; Processing Dependency: perl(HTTP::Daemon) for package: perl-JSON-2.15-5.el6.noarch      <br/>      ---&gt; Package perl-Time-HiRes.x86_64 4:1.9721-144.el6 will be installed      <br/>      ---&gt; Package perl-XML-LibXML.x86_64 1:1.70-5.el6 will be installed      <br/>      --&gt; Processing Dependency: perl(XML::SAX::Exception) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(XML::SAX::DocumentLocator) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(XML::SAX::Base) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(XML::NamespaceSupport) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64      <br/>      ---&gt; Package perl-parent.x86_64 1:0.221-144.el6 will be installed      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package perl-DBI.x86_64 0:1.609-4.el6 will be installed      <br/>      ---&gt; Package perl-Net-LibIDN.x86_64 0:0.12-3.el6 will be installed      <br/>      ---&gt; Package perl-Net-SSLeay.x86_64 0:1.35-10.el6_8.1 will be installed      <br/>      ---&gt; Package perl-XML-NamespaceSupport.noarch 0:1.10-3.el6 will be installed      <br/>      ---&gt; Package perl-XML-SAX.noarch 0:0.96-7.el6 will be installed      <br/>      ---&gt; Package perl-libwww-perl.noarch 0:5.833-5.el6 will be installed      <br/>      --&gt; Processing Dependency: perl-HTML-Parser &gt;= 3.33 for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Processing Dependency: perl(URI::URL) for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Processing Dependency: perl(URI::Heuristic) for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Processing Dependency: perl(URI) for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Processing Dependency: perl(HTML::Entities) for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Processing Dependency: perl(Compress::Zlib) for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Processing Dependency: mailcap for package: perl-libwww-perl-5.833-5.el6.noarch      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package mailcap.noarch 0:2.1.31-2.el6 will be installed      <br/>      ---&gt; Package perl-Compress-Zlib.x86_64 0:2.021-144.el6 will be installed      <br/>      --&gt; Processing Dependency: perl(IO::Uncompress::Gunzip) &gt;= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(IO::Compress::Gzip::Constants) &gt;= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(IO::Compress::Gzip) &gt;= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(IO::Compress::Base::Common) &gt;= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(Compress::Raw::Zlib) &gt;= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64      <br/>      ---&gt; Package perl-HTML-Parser.x86_64 0:3.64-2.el6 will be installed      <br/>      --&gt; Processing Dependency: perl(HTML::Tagset) &gt;= 3.03 for package: perl-HTML-Parser-3.64-2.el6.x86_64      <br/>      --&gt; Processing Dependency: perl(HTML::Tagset) for package: perl-HTML-Parser-3.64-2.el6.x86_64      <br/>      ---&gt; Package perl-URI.noarch 0:1.40-2.el6 will be installed      <br/>      --&gt; Running transaction check      <br/>      ---&gt; Package perl-Compress-Raw-Zlib.x86_64 1:2.021-144.el6 will be installed      <br/>      ---&gt; Package perl-HTML-Tagset.noarch 0:3.20-4.el6 will be installed      <br/>      ---&gt; Package perl-IO-Compress-Base.x86_64 0:2.021-144.el6 will be installed      <br/>      ---&gt; Package perl-IO-Compress-Zlib.x86_64 0:2.021-144.el6 will be installed      <br/>      --&gt; Finished Dependency Resolution      <br/>      <br/>      Dependencies Resolved      <br/>      <br/>      ===========================================================================================================      <br/>       Package                             Arch             Version                       Repository        Size      <br/>      ===========================================================================================================      <br/>      Installing:      <br/>       pgbackrest                          x86_64           2.05-1.rhel6                  pgdg96           203 k      <br/>      Installing for dependencies:      <br/>       mailcap                             noarch           2.1.31-2.el6                  base              27 k      <br/>       perl-Compress-Raw-Zlib              x86_64           1:2.021-144.el6               base              70 k      <br/>       perl-Compress-Zlib                  x86_64           2.021-144.el6                 base              46 k      <br/>       perl-DBD-Pg                         x86_64           2.15.1-4.el6_3                base             196 k      <br/>       perl-DBI                            x86_64           1.609-4.el6                   base             705 k      <br/>       perl-Digest-SHA                     x86_64           1:5.47-144.el6                base              65 k      <br/>       perl-HTML-Parser                    x86_64           3.64-2.el6                    base             109 k      <br/>       perl-HTML-Tagset                    noarch           3.20-4.el6                    base              17 k      <br/>       perl-IO-Compress-Base               x86_64           2.021-144.el6                 base              70 k      <br/>       perl-IO-Compress-Zlib               x86_64           2.021-144.el6                 base             136 k      <br/>       perl-IO-Socket-SSL                  noarch           1.31-3.el6_8.2                base              70 k      <br/>       perl-JSON                           noarch           2.15-5.el6                    base              97 k      <br/>       perl-Net-LibIDN                     x86_64           0.12-3.el6                    base              35 k      <br/>       perl-Net-SSLeay                     x86_64           1.35-10.el6_8.1               base             174 k      <br/>       perl-Time-HiRes                     x86_64           4:1.9721-144.el6              base              49 k      <br/>       perl-URI                            noarch           1.40-2.el6                    base             117 k      <br/>       perl-XML-LibXML                     x86_64           1:1.70-5.el6                  base             364 k      <br/>       perl-XML-NamespaceSupport           noarch           1.10-3.el6                    base              17 k      <br/>       perl-XML-SAX                        noarch           0.96-7.el6                    base              78 k      <br/>       perl-libwww-perl                    noarch           5.833-5.el6                   base             390 k      <br/>       perl-parent                         x86_64           1:0.221-144.el6               base              28 k      <br/>      <br/>      Transaction Summary      <br/>      ===========================================================================================================      <br/>      Install      22 Package(s)      <br/>      <br/>      Total download size: 3.0 M      <br/>      Installed size: 7.5 M      <br/>      Downloading Packages:      <br/>      (1/22): mailcap-2.1.31-2.el6.noarch.rpm                                             |  27 kB     00:00      <br/>      (2/22): perl-Compress-Raw-Zlib-2.021-144.el6.x86_64.rpm                             |  70 kB     00:00      <br/>      (3/22): perl-Compress-Zlib-2.021-144.el6.x86_64.rpm                                 |  46 kB     00:00      <br/>      (4/22): perl-DBD-Pg-2.15.1-4.el6_3.x86_64.rpm                                       | 196 kB     00:00      <br/>      (5/22): perl-DBI-1.609-4.el6.x86_64.rpm                                             | 705 kB     00:00      <br/>      (6/22): perl-Digest-SHA-5.47-144.el6.x86_64.rpm                                     |  65 kB     00:00      <br/>      (7/22): perl-HTML-Parser-3.64-2.el6.x86_64.rpm                                      | 109 kB     00:00      <br/>      (8/22): perl-HTML-Tagset-3.20-4.el6.noarch.rpm                                      |  17 kB     00:00      <br/>      (9/22): perl-IO-Compress-Base-2.021-144.el6.x86_64.rpm                              |  70 kB     00:00      <br/>      (10/22): perl-IO-Compress-Zlib-2.021-144.el6.x86_64.rpm                             | 136 kB     00:00      <br/>      (11/22): perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch.rpm                               |  70 kB     00:00      <br/>      (12/22): perl-JSON-2.15-5.el6.noarch.rpm                                            |  97 kB     00:00      <br/>      (13/22): perl-Net-LibIDN-0.12-3.el6.x86_64.rpm                                      |  35 kB     00:00      <br/>      (14/22): perl-Net-SSLeay-1.35-10.el6_8.1.x86_64.rpm                                 | 174 kB     00:00      <br/>      (15/22): perl-Time-HiRes-1.9721-144.el6.x86_64.rpm                                  |  49 kB     00:00      <br/>      (16/22): perl-URI-1.40-2.el6.noarch.rpm                                             | 117 kB     00:00      <br/>      (17/22): perl-XML-LibXML-1.70-5.el6.x86_64.rpm                                      | 364 kB     00:00      <br/>      (18/22): perl-XML-NamespaceSupport-1.10-3.el6.noarch.rpm                            |  17 kB     00:00      <br/>      (19/22): perl-XML-SAX-0.96-7.el6.noarch.rpm                                         |  78 kB     00:00      <br/>      (20/22): perl-libwww-perl-5.833-5.el6.noarch.rpm                                    | 390 kB     00:00      <br/>      (21/22): perl-parent-0.221-144.el6.x86_64.rpm                                       |  28 kB     00:00      <br/>      (22/22): pgbackrest-2.05-1.rhel6.x86_64.rpm                                         | 203 kB     00:00      <br/>      -----------------------------------------------------------------------------------------------------------      <br/>      Total                                                                      1.1 MB/s | 3.0 MB     00:02      <br/>      Running rpm_check_debug      <br/>      Running Transaction Test      <br/>      Transaction Test Succeeded      <br/>      Running Transaction      <br/>        Installing : perl-IO-Compress-Base-2.021-144.el6.x86_64                                             1/22      <br/>        Installing : 1:perl-Compress-Raw-Zlib-2.021-144.el6.x86_64                                          2/22      <br/>        Installing : perl-XML-NamespaceSupport-1.10-3.el6.noarch                                            3/22      <br/>        Installing : 1:perl-XML-LibXML-1.70-5.el6.x86_64                                                    4/22      <br/>        Installing : perl-XML-SAX-0.96-7.el6.noarch                                                         5/22      <br/>        Installing : perl-IO-Compress-Zlib-2.021-144.el6.x86_64                                             6/22      <br/>        Installing : perl-Compress-Zlib-2.021-144.el6.x86_64                                                7/22      <br/>        Installing : 1:perl-Digest-SHA-5.47-144.el6.x86_64                                                  8/22      <br/>        Installing : 1:perl-parent-0.221-144.el6.x86_64                                                     9/22      <br/>        Installing : perl-DBI-1.609-4.el6.x86_64                                                           10/22      <br/>        Installing : perl-DBD-Pg-2.15.1-4.el6_3.x86_64                                                     11/22      <br/>        Installing : perl-HTML-Tagset-3.20-4.el6.noarch                                                    12/22      <br/>        Installing : perl-HTML-Parser-3.64-2.el6.x86_64                                                    13/22      <br/>        Installing : perl-URI-1.40-2.el6.noarch                                                            14/22      <br/>        Installing : perl-Net-LibIDN-0.12-3.el6.x86_64                                                     15/22      <br/>        Installing : mailcap-2.1.31-2.el6.noarch                                                           16/22      <br/>        Installing : perl-libwww-perl-5.833-5.el6.noarch                                                   17/22      <br/>        Installing : perl-JSON-2.15-5.el6.noarch                                                           18/22      <br/>        Installing : 4:perl-Time-HiRes-1.9721-144.el6.x86_64                                               19/22      <br/>        Installing : perl-Net-SSLeay-1.35-10.el6_8.1.x86_64                                                20/22      <br/>        Installing : perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch                                              21/22      <br/>        Installing : pgbackrest-2.05-1.rhel6.x86_64                                                        22/22      <br/>        Verifying  : perl-Compress-Zlib-2.021-144.el6.x86_64                                                1/22      <br/>        Verifying  : perl-Net-SSLeay-1.35-10.el6_8.1.x86_64                                                 2/22      <br/>        Verifying  : pgbackrest-2.05-1.rhel6.x86_64                                                         3/22      <br/>        Verifying  : 4:perl-Time-HiRes-1.9721-144.el6.x86_64                                                4/22      <br/>        Verifying  : mailcap-2.1.31-2.el6.noarch                                                            5/22      <br/>        Verifying  : perl-Net-LibIDN-0.12-3.el6.x86_64                                                      6/22      <br/>        Verifying  : perl-libwww-perl-5.833-5.el6.noarch                                                    7/22      <br/>        Verifying  : perl-XML-NamespaceSupport-1.10-3.el6.noarch                                            8/22      <br/>        Verifying  : perl-DBD-Pg-2.15.1-4.el6_3.x86_64                                                      9/22      <br/>        Verifying  : perl-HTML-Parser-3.64-2.el6.x86_64                                                    10/22      <br/>        Verifying  : 1:perl-XML-LibXML-1.70-5.el6.x86_64                                                   11/22      <br/>        Verifying  : 1:perl-Compress-Raw-Zlib-2.021-144.el6.x86_64                                         12/22      <br/>        Verifying  : perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch                                              13/22      <br/>        Verifying  : perl-URI-1.40-2.el6.noarch                                                            14/22      <br/>        Verifying  : perl-IO-Compress-Base-2.021-144.el6.x86_64                                            15/22      <br/>        Verifying  : perl-HTML-Tagset-3.20-4.el6.noarch                                                    16/22      <br/>        Verifying  : perl-DBI-1.609-4.el6.x86_64                                                           17/22      <br/>        Verifying  : perl-XML-SAX-0.96-7.el6.noarch                                                        18/22      <br/>        Verifying  : 1:perl-parent-0.221-144.el6.x86_64                                                    19/22      <br/>        Verifying  : 1:perl-Digest-SHA-5.47-144.el6.x86_64                                                 20/22      <br/>        Verifying  : perl-IO-Compress-Zlib-2.021-144.el6.x86_64                                            21/22      <br/>        Verifying  : perl-JSON-2.15-5.el6.noarch                                                           22/22      <br/>      <br/>      Installed:      <br/>        pgbackrest.x86_64 0:2.05-1.rhel6      <br/>      <br/>      Dependency Installed:      <br/>        mailcap.noarch 0:2.1.31-2.el6                       perl-Compress-Raw-Zlib.x86_64 1:2.021-144.el6      <br/>        perl-Compress-Zlib.x86_64 0:2.021-144.el6           perl-DBD-Pg.x86_64 0:2.15.1-4.el6_3      <br/>        perl-DBI.x86_64 0:1.609-4.el6                       perl-Digest-SHA.x86_64 1:5.47-144.el6      <br/>        perl-HTML-Parser.x86_64 0:3.64-2.el6                perl-HTML-Tagset.noarch 0:3.20-4.el6      <br/>        perl-IO-Compress-Base.x86_64 0:2.021-144.el6        perl-IO-Compress-Zlib.x86_64 0:2.021-144.el6      <br/>        perl-IO-Socket-SSL.noarch 0:1.31-3.el6_8.2          perl-JSON.noarch 0:2.15-5.el6      <br/>        perl-Net-LibIDN.x86_64 0:0.12-3.el6                 perl-Net-SSLeay.x86_64 0:1.35-10.el6_8.1      <br/>        perl-Time-HiRes.x86_64 4:1.9721-144.el6             perl-URI.noarch 0:1.40-2.el6      <br/>        perl-XML-LibXML.x86_64 1:1.70-5.el6                 perl-XML-NamespaceSupport.noarch 0:1.10-3.el6      <br/>        perl-XML-SAX.noarch 0:0.96-7.el6                    perl-libwww-perl.noarch 0:5.833-5.el6      <br/>        perl-parent.x86_64 1:0.221-144.el6      <br/>      <br/>      Complete!    </xhtml:code>    <xhtml:p>      Once installed,       <xhtml:span class=\"inline_block\">        pgBackRest      </xhtml:span>       must be configured for things like stanza name, backup location, retention policy, logging, etc. Please consult the       <xhtml:a href=\"http://pgbackrest.org/configuration.html\">        configuration guide      </xhtml:a>      .    </xhtml:p>    <xhtml:p>      If employing       <xhtml:span class=\"inline_block\">        pgBackRest      </xhtml:span>       for your backup/recovery solution, ensure the repository, base backups, and WAL archives are stored on a reliable file system separate from the database server. Further, the external storage system where backups resided should have limited access to only those system administrators as necessary. Finally, as with any backup/recovery solution, stringent testing must be conducted. A backup is only good if it can be restored successfully.    </xhtml:p>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        },
                        {
                            "Rules": [
                                {
                                    "Rule": {
                                        "id": "xccdf_org.cisecurity.benchmarks_rule_8.4_Ensure_miscellaneous_configuration_settings_are_correct",
                                        "title": "Ensure miscellaneous configuration settings are correct",
                                        "description": "<xhtml:p>  This recommendation covers non-regular, special files, and dynamic libraries.</xhtml:p><xhtml:p>  PostgreSQL permits local logins via the UNIX DOMAIN SOCKET and, for the most part, anyone with a legitimate Unix login account can make the attempt. Limiting PostgreSQL login attempts can be made by relocating the UNIX DOMAIN SOCKET to a subdirectory with restricted permissions.</xhtml:p><xhtml:p>  The creation and implementation of user-defined dynamic libraries is an extraordinary powerful capability. In the hands of an experienced DBA/programmer, it can significantly enhance the power and flexibility of the RDBMS. But new and unexpected behavior can also be assigned to the RDBMS, resulting in a very dangerous environment in what should otherwise be trusted.</xhtml:p>",
                                        "metadata": {
                                            "xmls:controls": "http://cisecurity.org/controls",
                                            "framework": {
                                                "urn": "urn:cisecurity.org:controls:6.0",
                                                "safeguard": [
                                                    {
                                                        "title": "Use Standard Hardening Configuration Templates for Databases",
                                                        "urn": "urn:cisecurity.org:controls:7.0:18:11",
                                                        "implementationGroups": {
                                                            "ig3": "true",
                                                            "ig1": "null",
                                                            "ig2": "true"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    },
                                                    {
                                                        "title": "Use Standard Database Hardening Templates",
                                                        "urn": "urn:cisecurity.org:controls:6.0:18:7",
                                                        "implementationGroups": {
                                                            "ig3": "null",
                                                            "ig1": "null",
                                                            "ig2": "null"
                                                        },
                                                        "assetType": "",
                                                        "securityFunction": ""
                                                    }
                                                ]
                                            }
                                        },
                                        "rationale": "",
                                        "idents": [
                                            {
                                                "system": "http://cisecurity.org/20-cc/v6.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/7"
                                            },
                                            {
                                                "system": "http://cisecurity.org/20-cc/v7.0",
                                                "controlURI": "http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-file-locations.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-connection.html"
                                            },
                                            {
                                                "system": "http://cce.mitre.org",
                                                "controlURI": "",
                                                "systemValue": "https://www.postgresql.org/docs/9.6/static/runtime-config-client.html"
                                            }
                                        ],
                                        "fixtext": "<xhtml:div>  <xhtml:p>    <xhtml:p>      Follow these steps to remediate the configuration:    </xhtml:p>    <xhtml:ul>      <xhtml:li>        Determine permissions based on your organization's security policies.      </xhtml:li>      <xhtml:li>        Relocate all files and ensure their permissions are restricted as much as possible, i.e. only superuser read access.      </xhtml:li>      <xhtml:li>        Ensure all directories where these files are located have restricted permissions such that the superuser can read but not write.      </xhtml:li>      <xhtml:li>        Lastly, change the settings accordingly in the         <xhtml:span class=\"inline_block\">          postgresql.conf        </xhtml:span>         configuration file and restart the database cluster for changes to take effect.      </xhtml:li>    </xhtml:ul>  </xhtml:p></xhtml:div>"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        ],
        "ScriptCheckEngineScripts": [
            {
                "name": "find_pgwheel_group.sh",
                "script": "#!/usr/bin/env bash\n\n#\n# CIS-CAT Script Check Engine\n# \n# Name         Date       Description\n# -------------------------------------------------------------------\n# T. Harrison  8/1/18    Ensure pg_wheel group exists\n#\nshopt -s nocasematch\noutput=$(getent group pg_wheel)\ngroup=$(grep -Po '^[^:]*pg_wheel(?=(:[^:]*)*$)' <<<  $output)\ngroup_members=$(echo $output | grep -oP \"^pg_wheel\\:x\\:\\d+\\:\\K[\\w,]+\")\n\nif [[ \"$group\" =~ ^[^:]*pg_wheel[^:]*$ ]] ; then\n    echo \"$group\"\n    echo \"----------------------\"\n    echo \"$group_members\" | tr ',' '\\n'\n    shopt -u nocasematch\n    exit \"${XCCDF_RESULT_PASS:-101}\"\nelse\n    # print the reason why we are failing\n    echo \"No 'pg_wheel' group was found.\"\n    shopt -u nocasematch\n    exit \"${XCCDF_RESULT_FAIL:-102}\"\nfi"
            },
            {
                "name": "openssl_fips_140-2.sh",
                "script": "#!/usr/bin/env bash\n\n#\n# CIS-CAT Script Check Engine\n# \n# Name         Date       Description\n# -------------------------------------------------------------------\n# T. Harrison  6/19/18    Ensure FIPS 140-2 OpenSSL Cryptography Is Used\n#\n\noutput=$(cat /proc/sys/crypto/fips_enabled)\n\nif [ \"$output\" = 1 ] ; then\n    echo \"$output\"\n    exit \"${XCCDF_RESULT_PASS:-101}\"\nelse\n    #test for fips capable system\n    openssl_version=$(openssl version)\n    fips_capable=$(echo \"$openssl_version\" | egrep \"(?!^OpenSSL.+-)fips(?=.+$)\")\n    \n    echo $output\n    echo $openssl_version\n    # print the reason why we are failing\n    if [ \"$fips_capable\" = 'fips' ] ; then\n        echo \"FIPS not enabled\"\n    else\n        echo \"System is not FIPS capable\"\n    fi\n    exit \"${XCCDF_RESULT_FAIL:-102}\"\nfi"
            }
        ]
    }
}